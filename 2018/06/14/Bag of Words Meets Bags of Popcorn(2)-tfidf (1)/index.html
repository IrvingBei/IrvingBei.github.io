<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />

    

    
    <title>Bag of Words Meets Bags of Popcorn(2)-tfidf | 以梦为码</title>
    
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
        <meta name="keywords" content="Kaggle,文本分类" />
    
    <meta name="description" content="本篇是kaggle之电影评论文本情感分类（Bag of Words Meets Bags of Popcorn）实现的第二篇，语言模型选择的是TFIDF主要参考：https://www.kaggle.com/rajathmc/bag-of-words-meets-bags-of-popcornhttps://www.cnblogs.com/lijingpeng/p/5787549.html这两篇文">
<meta name="keywords" content="Kaggle,文本分类">
<meta property="og:type" content="article">
<meta property="og:title" content="Bag of Words Meets Bags of Popcorn(2)-tfidf">
<meta property="og:url" content="http://yoursite.com/2018/06/14/Bag of Words Meets Bags of Popcorn(2)-tfidf (1)/index.html">
<meta property="og:site_name" content="以梦为码">
<meta property="og:description" content="本篇是kaggle之电影评论文本情感分类（Bag of Words Meets Bags of Popcorn）实现的第二篇，语言模型选择的是TFIDF主要参考：https://www.kaggle.com/rajathmc/bag-of-words-meets-bags-of-popcornhttps://www.cnblogs.com/lijingpeng/p/5787549.html这两篇文">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://raw.githubusercontent.com/xiongzongyang/hexo_photo/master/bag.png">
<meta property="og:updated_time" content="2018-07-17T02:55:46.338Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Bag of Words Meets Bags of Popcorn(2)-tfidf">
<meta name="twitter:description" content="本篇是kaggle之电影评论文本情感分类（Bag of Words Meets Bags of Popcorn）实现的第二篇，语言模型选择的是TFIDF主要参考：https://www.kaggle.com/rajathmc/bag-of-words-meets-bags-of-popcornhttps://www.cnblogs.com/lijingpeng/p/5787549.html这两篇文">
<meta name="twitter:image" content="https://raw.githubusercontent.com/xiongzongyang/hexo_photo/master/bag.png">
    

    

    
        <link rel="icon" href="/css/image/icon.png" />
    

    <link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="/libs/titillium-web/styles.css">
    <link rel="stylesheet" href="/libs/source-code-pro/styles.css">

    <link rel="stylesheet" href="/css/style.css">

    <script src="/libs/jquery/3.3.1/jquery.min.js"></script>
    
    
        <link rel="stylesheet" href="/libs/lightgallery/css/lightgallery.min.css">
    
    
        <link rel="stylesheet" href="/libs/justified-gallery/justifiedGallery.min.css">
    
    
    


</head>

<body>
    <div id="wrap">
        <header id="header">
    <div id="header-outer" class="outer">
        <div class="container">
            <div class="container-inner">
                <div id="header-title">
                    <h1 class="logo-wrap">
                        <a href="/" class="logo"></a>
                    </h1>
                    
                        <h2 class="subtitle-wrap">
                            <p class="subtitle">Keep Learning!</p>
                        </h2>
                    
                </div>
                <div id="header-inner" class="nav-container">
                    <a id="main-nav-toggle" class="nav-icon fa fa-bars"></a>
                    <div class="nav-container-inner">
                        <ul id="main-nav">
                            
                                <li class="main-nav-list-item" >
                                    <a class="main-nav-list-link" href="/">Home</a>
                                </li>
                            
                                        <ul class="main-nav-list"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/C-C/">C/C++</a><ul class="main-nav-list-child"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/C-C/leetcode/">leetcode</a></li></ul></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Experiment/">Experiment</a><ul class="main-nav-list-child"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Experiment/C/">C++</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Experiment/PHP/">PHP</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Experiment/Python/">Python</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Experiment/Scrapy/">Scrapy</a></li></ul></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Kaggle/">Kaggle</a><ul class="main-nav-list-child"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Kaggle/nlp/">nlp</a></li></ul></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Material/">Material</a><ul class="main-nav-list-child"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Material/DL/">DL</a></li></ul></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/NLP/">NLP</a><ul class="main-nav-list-child"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/NLP/MDCourse/">MDCourse</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/NLP/NLTK/">NLTK</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/NLP/Text-similarity/">Text similarity</a></li></ul></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/NOTES/">NOTES</a><ul class="main-nav-list-child"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/NOTES/Keras/">Keras</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/NOTES/Statistical/">Statistical</a></li></ul></li></ul>
                                    
                                <li class="main-nav-list-item" >
                                    <a class="main-nav-list-link" href="/about/">About</a>
                                </li>
                            
                        </ul>
                        <nav id="sub-nav">
                            <div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="搜索" />
        <button type="submit" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="想要查找什么..." />
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(未命名)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js"></script>

</div>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
    </div>
</header>
        <div class="container">
            <div class="main-body container-inner">
                <div class="main-body-inner">
                    <section id="main">
                        <div class="main-body-header">
    <h1 class="header">
    
    <a class="page-title-link" href="/categories/Kaggle/">Kaggle</a><i class="icon fa fa-angle-right"></i><a class="page-title-link" href="/categories/Kaggle/nlp/">nlp</a>
    </h1>
</div>
                        <div class="main-body-content">
                            <article id="post-Bag of Words Meets Bags of Popcorn(2)-tfidf (1)" class="article article-single article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
            <header class="article-header">
                
    
        <h1 class="article-title" itemprop="name">
        Bag of Words Meets Bags of Popcorn(2)-tfidf
        </h1>
    

            </header>
        
        
            <div class="article-meta">
                
    <div class="article-date">
        <a href="/2018/06/14/Bag of Words Meets Bags of Popcorn(2)-tfidf (1)/" class="article-date">
            <time datetime="2018-06-14T06:33:55.000Z" itemprop="datePublished">2018-06-14</time>
        </a>
    </div>

                
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/Kaggle/">Kaggle</a>, <a class="tag-link" href="/tags/文本分类/">文本分类</a>
    </div>

            </div>
        
        
        <div class="article-entry" itemprop="articleBody">
            <p>本篇是kaggle之电影评论文本情感分类（Bag of Words Meets Bags of Popcorn）实现的第二篇，语言模型选择的是TFIDF<br>主要参考：<a href="https://www.kaggle.com/rajathmc/bag-of-words-meets-bags-of-popcorn" target="_blank" rel="noopener">https://www.kaggle.com/rajathmc/bag-of-words-meets-bags-of-popcorn</a><br><a href="https://www.cnblogs.com/lijingpeng/p/5787549.html" target="_blank" rel="noopener">https://www.cnblogs.com/lijingpeng/p/5787549.html</a><br>这两篇文章，部分地方有修改。<br><a id="more"></a></p>
<h4 id="0、主要思路"><a href="#0、主要思路" class="headerlink" title="0、主要思路"></a>0、主要思路</h4><p>（1）首先使用第一篇中数据清洗方法对训练集和测试集的数据进行清洗；前一篇<a href="http://bei.dreamcykj.com/2018/06/13/Bag%20of%20Words%20Meets%20Bags%20of%20Popcorn(1)-Bag%20of%20Words/#more" target="_blank" rel="noopener">http://bei.dreamcykj.com/2018/06/13/Bag%20of%20Words%20Meets%20Bags%20of%20Popcorn(1)-Bag%20of%20Words/#more</a></p>
<p>（2）利用sklearn中文本特征提取方法将数据向量化，并对训练集和测试集提取tfidf特征；</p>
<p>（3）选择适当的分类算法，在训练集上训练，并在测试集上进行测试，保存预测结果。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> nltk.corpus <span class="keyword">import</span> stopwords</span><br></pre></td></tr></table></figure>
<h4 id="1、读取数据"><a href="#1、读取数据" class="headerlink" title="1、读取数据"></a>1、读取数据</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">train=pd.read_csv(<span class="string">"./data/labeledTrainData.tsv"</span>,header=<span class="number">0</span>,delimiter=<span class="string">"\t"</span>,quoting=<span class="number">3</span>)</span><br><span class="line">test=pd.read_csv(<span class="string">"./data/testData.tsv"</span>,header=<span class="number">0</span>,delimiter=<span class="string">"\t"</span>,quoting=<span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<h4 id="2、数据清洗"><a href="#2、数据清洗" class="headerlink" title="2、数据清洗"></a>2、数据清洗</h4><p>这里直接给出数据清洗方法，分析过程见<a href="http://bei.dreamcykj.com/2018/06/13/Bag%20of%20Words%20Meets%20Bags%20of%20Popcorn(1)-Bag%20of%20Words/#more" target="_blank" rel="noopener">http://bei.dreamcykj.com/2018/06/13/Bag%20of%20Words%20Meets%20Bags%20of%20Popcorn(1)-Bag%20of%20Words/#more</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">review_to_words</span><span class="params">(raw_review)</span>:</span></span><br><span class="line">    <span class="comment"># 去掉html标签</span></span><br><span class="line">    review_text=BeautifulSoup(raw_review).get_text()</span><br><span class="line">    <span class="comment"># 去掉标点符号和非法字符</span></span><br><span class="line">    review_text=re.sub(<span class="string">"[^a-zA-Z]"</span>,<span class="string">" "</span>,review_text)</span><br><span class="line">    <span class="comment"># 将字符全部转化为小写，并通过空格符进行分词处理</span></span><br><span class="line">    words=review_text.lower().split()</span><br><span class="line">    <span class="comment"># 去停用词</span></span><br><span class="line">    stops=set(stopwords.words(<span class="string">"english"</span>))</span><br><span class="line">    meaningful_words=[w <span class="keyword">for</span> w <span class="keyword">in</span> words <span class="keyword">if</span> w <span class="keyword">not</span> <span class="keyword">in</span> stops]</span><br><span class="line">    <span class="comment"># 将剩下的词还原成str类型</span></span><br><span class="line">    cleaned_review=<span class="string">" "</span>.join(meaningful_words)</span><br><span class="line">    <span class="keyword">return</span> cleaned_review</span><br></pre></td></tr></table></figure>
<h4 id="3、提取特征"><a href="#3、提取特征" class="headerlink" title="3、提取特征"></a>3、提取特征</h4><h5 id="3、1-准备数据"><a href="#3、1-准备数据" class="headerlink" title="3、1 准备数据"></a>3、1 准备数据</h5><p>这一步和前一篇的类似，分别清洗训练集和测试集。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取数据的数量</span></span><br><span class="line">num_reviews=len(train)</span><br><span class="line"><span class="comment"># 对数据进行清洗</span></span><br><span class="line">clean_train_reviews=[]</span><br><span class="line">print(<span class="string">"Cleaning and parsing the training set movie reviews...\n"</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,num_reviews):</span><br><span class="line">    <span class="keyword">if</span>(i+<span class="number">1</span>)%<span class="number">1000</span>==<span class="number">0</span>:</span><br><span class="line">        print(<span class="string">"Review %d of %d \n"</span> % (i+<span class="number">1</span>, num_reviews))</span><br><span class="line">    temp_review=review_to_words(train[<span class="string">"review"</span>][i])</span><br><span class="line">    clean_train_reviews.append(temp_review)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 对测试集数据做相同的处理</span></span><br><span class="line">num_reviews=len(test)</span><br><span class="line">clean_test_reviews=[]</span><br><span class="line">print(<span class="string">"Cleaning and parsing the training set movie reviews...\n"</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,num_reviews):</span><br><span class="line">    <span class="keyword">if</span>(i+<span class="number">1</span>)%<span class="number">1000</span>==<span class="number">0</span>:</span><br><span class="line">        print(<span class="string">"Review %d of %d \n"</span>%(i+<span class="number">1</span>,num_reviews))</span><br><span class="line">    temp_review=review_to_words(test[<span class="string">"review"</span>][i])</span><br><span class="line">    clean_test_reviews.append(temp_review)</span><br><span class="line">print(len(clean_train_reviews))</span><br><span class="line">print(len(clean_test_reviews))</span><br></pre></td></tr></table></figure>
<pre><code>Cleaning and parsing the training set movie reviews...

/home/xiongzy/anaconda3/lib/python3.6/site-packages/bs4/__init__.py:181: UserWarning: No parser was explicitly specified, so I&apos;m using the best available HTML parser for this system (&quot;lxml&quot;). This usually isn&apos;t a problem, but if you run this code on another system, or in a different virtual environment, it may use a different parser and behave differently. 
The code that caused this warning is on line 193 of the file /home/xiongzy/anaconda3/lib/python3.6/runpy.py. To get rid of this warning, change code that looks like this:

 BeautifulSoup(YOUR_MARKUP})   
to this:

 BeautifulSoup(YOUR_MARKUP, &quot;lxml&quot;)

  markup_type=markup_type))
Review 1000 of 25000 

Review 2000 of 25000 

Review 3000 of 25000 

Review 4000 of 25000 

Review 5000 of 25000 

Review 6000 of 25000 

Review 7000 of 25000 

Review 8000 of 25000 

Review 9000 of 25000 

Review 10000 of 25000 

Review 11000 of 25000 

Review 12000 of 25000 

Review 13000 of 25000 

Review 14000 of 25000 

Review 15000 of 25000 

Review 16000 of 25000 

Review 17000 of 25000 

Review 18000 of 25000 

Review 19000 of 25000 

Review 20000 of 25000 

Review 21000 of 25000 

Review 22000 of 25000 

Review 23000 of 25000 

Review 24000 of 25000 

Review 25000 of 25000 

Cleaning and parsing the training set movie reviews...

Review 1000 of 25000 

Review 2000 of 25000 

Review 3000 of 25000 

Review 4000 of 25000 

Review 5000 of 25000 

Review 6000 of 25000 

Review 7000 of 25000 

Review 8000 of 25000 

Review 9000 of 25000 

Review 10000 of 25000 

Review 11000 of 25000 

Review 12000 of 25000 

Review 13000 of 25000 

Review 14000 of 25000 

Review 15000 of 25000 

Review 16000 of 25000 

Review 17000 of 25000 

Review 18000 of 25000 

Review 19000 of 25000 

Review 20000 of 25000 

Review 21000 of 25000 

Review 22000 of 25000 

Review 23000 of 25000 

Review 24000 of 25000 

Review 25000 of 25000 

25000
25000
</code></pre><h5 id="3、2-数据向量化"><a href="#3、2-数据向量化" class="headerlink" title="3、2  数据向量化"></a>3、2  数据向量化</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.feature_extraction.text <span class="keyword">import</span> TfidfVectorizer <span class="keyword">as</span> TF</span><br><span class="line"></span><br><span class="line">tfidf=TF(analyzer=<span class="string">"word"</span>,tokenizer=<span class="keyword">None</span>,preprocessor=<span class="keyword">None</span>,stop_words=<span class="keyword">None</span>,max_features=<span class="number">5000</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 合并训练和测试集以便进行tfidf向量化操作</span></span><br><span class="line">data_all=clean_train_reviews+clean_test_reviews</span><br><span class="line"></span><br><span class="line"><span class="comment"># 数据向量化</span></span><br><span class="line">print(<span class="string">"Creating the tfidf vector...\n"</span>)</span><br><span class="line">tfidf.fit(data_all)</span><br><span class="line"><span class="comment"># 获取训练集的向量表示</span></span><br><span class="line">train_x=tfidf.transform(clean_train_reviews)</span><br><span class="line">train_x=train_x.toarray()</span><br><span class="line"><span class="comment"># 获取测试集的向量表示</span></span><br><span class="line">test_x=tfidf.transform(clean_test_reviews)</span><br><span class="line">test_x=test_x.toarray()</span><br><span class="line">print(train_x.shape)</span><br><span class="line">print(test_x.shape)</span><br><span class="line">print(<span class="string">"finished"</span>)</span><br></pre></td></tr></table></figure>
<pre><code>Creating the tfidf vector...

(25000, 5000)
(25000, 5000)
finished
</code></pre><h4 id="4、-建模和训练"><a href="#4、-建模和训练" class="headerlink" title="4、 建模和训练"></a>4、 建模和训练</h4><p>这里分别对朴素贝叶斯和逻辑回归进行了测试，发现逻辑回归的效果较好。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.naive_bayes <span class="keyword">import</span> MultinomialNB <span class="keyword">as</span> MNB</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LogisticRegression <span class="keyword">as</span> LR</span><br><span class="line"><span class="keyword">from</span> sklearn.grid_search <span class="keyword">import</span> GridSearchCV</span><br></pre></td></tr></table></figure>
<pre><code>/home/xiongzy/anaconda3/lib/python3.6/site-packages/sklearn/cross_validation.py:41: DeprecationWarning: This module was deprecated in version 0.18 in favor of the model_selection module into which all the refactored classes and functions are moved. Also note that the interface of the new CV iterators are different from that of this module. This module will be removed in 0.20.
  &quot;This module will be removed in 0.20.&quot;, DeprecationWarning)
/home/xiongzy/anaconda3/lib/python3.6/site-packages/sklearn/grid_search.py:42: DeprecationWarning: This module was deprecated in version 0.18 in favor of the model_selection module into which all the refactored classes and functions are moved. This module will be removed in 0.20.
  DeprecationWarning)
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># model=MNB(alpha=1.0, class_prior=None, fit_prior=True)     # 朴素贝叶斯模型</span></span><br><span class="line">model = LR()                             <span class="comment"># 逻辑回归模型</span></span><br><span class="line">model.fit(train_x,train[<span class="string">"sentiment"</span>])</span><br></pre></td></tr></table></figure>
<pre><code>LogisticRegression(C=1.0, class_weight=None, dual=False, fit_intercept=True,
          intercept_scaling=1, max_iter=100, multi_class=&apos;ovr&apos;, n_jobs=1,
          penalty=&apos;l2&apos;, random_state=None, solver=&apos;liblinear&apos;, tol=0.0001,
          verbose=0, warm_start=False)
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.cross_validation <span class="keyword">import</span> cross_val_score</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">print(<span class="string">"10折交叉验证："</span>)</span><br><span class="line">print(np.mean(cross_val_score(model,train_x,train[<span class="string">"sentiment"</span>],scoring=<span class="string">"roc_auc"</span>)))</span><br></pre></td></tr></table></figure>
<pre><code>10折交叉验证：
0.9498602042713286
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">test_predicted=np.array(model.predict(test_x))</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">output=pd.DataFrame(data=&#123;<span class="string">"id"</span>:test[<span class="string">"id"</span>],<span class="string">"sentiment"</span>:test_predicted&#125;)</span><br><span class="line"><span class="comment"># 写入文件</span></span><br><span class="line">output.to_csv(<span class="string">"./data/tfidf.csv"</span>,index=<span class="keyword">False</span>,quoting=<span class="number">3</span>)</span><br></pre></td></tr></table></figure>

        </div>
        <footer class="article-footer">
            


    <div class="a2a_kit a2a_default_style">
    <a class="a2a_dd" href="https://www.addtoany.com/share">Share</a>
    <span class="a2a_divider"></span>
    <a class="a2a_button_facebook"></a>
    <a class="a2a_button_twitter"></a>
    <a class="a2a_button_google_plus"></a>
    <a class="a2a_button_pinterest"></a>
    <a class="a2a_button_tumblr"></a>
</div>
<script type="text/javascript" src="//static.addtoany.com/menu/page.js"></script>
<style>
    .a2a_menu {
        border-radius: 4px;
    }
    .a2a_menu a {
        margin: 2px 0;
        font-size: 14px;
        line-height: 16px;
        border-radius: 4px;
        color: inherit !important;
        font-family: 'Microsoft Yahei';
    }
    #a2apage_dropdown {
        margin: 10px 0;
    }
    .a2a_mini_services {
        padding: 10px;
    }
    a.a2a_i,
    i.a2a_i {
        width: 122px;
        line-height: 16px;
    }
    a.a2a_i .a2a_svg,
    a.a2a_more .a2a_svg {
        width: 16px;
        height: 16px;
        line-height: 16px;
        vertical-align: top;
        background-size: 16px;
    }
    a.a2a_i {
        border: none !important;
    }
    a.a2a_menu_show_more_less {
        margin: 0;
        padding: 10px 0;
        line-height: 16px;
    }
    .a2a_mini_services:after{content:".";display:block;height:0;clear:both;visibility:hidden}
    .a2a_mini_services{*+height:1%;}
</style>


        </footer>
    </div>
</article>

    <section id="comments">
    
        
    <div id="SOHUCS" sid="http://yoursite.com/2018/06/14/Bag of Words Meets Bags of Popcorn(2)-tfidf (1)/"></div>


    
    </section>


                        </div>
                    </section>
                    <aside id="sidebar">
    <a class="sidebar-toggle" title="Expand Sidebar"><i class="toggle icon"></i></a>
    <div class="sidebar-top">
        <p>关注我 :</p>
        <ul class="social-links">
            
                
                <li>
                    <a class="social-tooltip" title="github" href="https://github.com/xiongzongyang" target="_blank" rel="noopener">
                        <i class="icon fa fa-github"></i>
                    </a>
                </li>
                
            
        </ul>
    </div>
    
        
<nav id="article-nav">
    
        <a href="/2018/06/14/Bag of Words Meets Bags of Popcorn(3)-Word2Voc (1)/" id="article-nav-newer" class="article-nav-link-wrap">
        <strong class="article-nav-caption">下一篇</strong>
        <p class="article-nav-title">
        
            Bag of Words Meets Bags of Popcorn(3)-Word2Voc
        
        </p>
        <i class="icon fa fa-chevron-right" id="icon-chevron-right"></i>
    </a>
    
    
        <a href="/2018/06/13/Bag of Words Meets Bags of Popcorn(1)-Bag of Words/" id="article-nav-older" class="article-nav-link-wrap">
        <strong class="article-nav-caption">上一篇</strong>
        <p class="article-nav-title">Bag of Words Meets Bags of Popcorn(1)-Bag of Words</p>
        <i class="icon fa fa-chevron-left" id="icon-chevron-left"></i>
        </a>
    
</nav>

    
    <div class="widgets-container">
        
            
                

            
                
    <div class="widget-wrap">
        <h3 class="widget-title">最新文章</h3>
        <div class="widget">
            <ul id="recent-post" class="">
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2018/07/21/快速将非数值型目标变量转化为数值型变量/" class="thumbnail">
    
    
        <span style="background-image:url(https://raw.githubusercontent.com/xiongzongyang/hexo_photo/master/p1.jpg)" alt="快速将非数值型目标变量转化为数值型变量" class="thumbnail-image"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/Experiment/">Experiment</a><i class="icon fa fa-angle-right"></i><a class="article-category-link" href="/categories/Experiment/Python/">Python</a></p>
                            <p class="item-title"><a href="/2018/07/21/快速将非数值型目标变量转化为数值型变量/" class="title">快速将非数值型目标变量转化为数值型变量</a></p>
                            <p class="item-date"><time datetime="2018-07-21T02:04:47.000Z" itemprop="datePublished">2018-07-21</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2018/07/20/Keras examples-addition_rnn (1)/" class="thumbnail">
    
    
        <span style="background-image:url(https://raw.githubusercontent.com/xiongzongyang/hexo_photo/master/keras01.jpg)" alt="Keras examples-addition_rnn" class="thumbnail-image"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/NOTES/">NOTES</a><i class="icon fa fa-angle-right"></i><a class="article-category-link" href="/categories/NOTES/Keras/">Keras</a></p>
                            <p class="item-title"><a href="/2018/07/20/Keras examples-addition_rnn (1)/" class="title">Keras examples-addition_rnn</a></p>
                            <p class="item-date"><time datetime="2018-07-20T12:08:43.000Z" itemprop="datePublished">2018-07-20</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2018/06/14/Bag of Words Meets Bags of Popcorn(3)-Word2Voc (1)/" class="thumbnail">
    
    
        <span style="background-image:url(https://raw.githubusercontent.com/xiongzongyang/hexo_photo/master/bag.png)" alt="Bag of Words Meets Bags of Popcorn(3)-Word2Voc" class="thumbnail-image"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/Kaggle/">Kaggle</a><i class="icon fa fa-angle-right"></i><a class="article-category-link" href="/categories/Kaggle/nlp/">nlp</a></p>
                            <p class="item-title"><a href="/2018/06/14/Bag of Words Meets Bags of Popcorn(3)-Word2Voc (1)/" class="title">Bag of Words Meets Bags of Popcorn(3)-Word2Voc</a></p>
                            <p class="item-date"><time datetime="2018-06-14T09:27:51.000Z" itemprop="datePublished">2018-06-14</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2018/06/14/Bag of Words Meets Bags of Popcorn(2)-tfidf (1)/" class="thumbnail">
    
    
        <span style="background-image:url(https://raw.githubusercontent.com/xiongzongyang/hexo_photo/master/bag.png)" alt="Bag of Words Meets Bags of Popcorn(2)-tfidf" class="thumbnail-image"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/Kaggle/">Kaggle</a><i class="icon fa fa-angle-right"></i><a class="article-category-link" href="/categories/Kaggle/nlp/">nlp</a></p>
                            <p class="item-title"><a href="/2018/06/14/Bag of Words Meets Bags of Popcorn(2)-tfidf (1)/" class="title">Bag of Words Meets Bags of Popcorn(2)-tfidf</a></p>
                            <p class="item-date"><time datetime="2018-06-14T06:33:55.000Z" itemprop="datePublished">2018-06-14</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2018/06/13/Bag of Words Meets Bags of Popcorn(1)-Bag of Words/" class="thumbnail">
    
    
        <span style="background-image:url(https://raw.githubusercontent.com/xiongzongyang/hexo_photo/master/bag.png)" alt="Bag of Words Meets Bags of Popcorn(1)-Bag of Words" class="thumbnail-image"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/Kaggle/">Kaggle</a><i class="icon fa fa-angle-right"></i><a class="article-category-link" href="/categories/Kaggle/nlp/">nlp</a></p>
                            <p class="item-title"><a href="/2018/06/13/Bag of Words Meets Bags of Popcorn(1)-Bag of Words/" class="title">Bag of Words Meets Bags of Popcorn(1)-Bag of Words</a></p>
                            <p class="item-date"><time datetime="2018-06-13T13:26:19.000Z" itemprop="datePublished">2018-06-13</time></p>
                        </div>
                    </li>
                
            </ul>
        </div>
    </div>

            
                
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">分类</h3>
        <div class="widget">
            <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/C-C/">C/C++</a><span class="category-list-count">1</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/C-C/leetcode/">leetcode</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Experiment/">Experiment</a><span class="category-list-count">6</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Experiment/C/">C++</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Experiment/PHP/">PHP</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Experiment/Python/">Python</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Experiment/Scrapy/">Scrapy</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Kaggle/">Kaggle</a><span class="category-list-count">3</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Kaggle/nlp/">nlp</a><span class="category-list-count">3</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Material/">Material</a><span class="category-list-count">2</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Material/DL/">DL</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/NLP/">NLP</a><span class="category-list-count">8</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/NLP/MDCourse/">MDCourse</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/NLP/NLTK/">NLTK</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/NLP/Text-similarity/">Text similarity</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/NOTES/">NOTES</a><span class="category-list-count">2</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/NOTES/Keras/">Keras</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/NOTES/Statistical/">Statistical</a><span class="category-list-count">1</span></li></ul></li></ul>
        </div>
    </div>


            
                
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">归档</h3>
        <div class="widget">
            <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">七月 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">六月 2018</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">三月 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">一月 2018</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">十二月 2017</a><span class="archive-list-count">8</span></li></ul>
        </div>
    </div>


            
                
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">标签</h3>
        <div class="widget">
            <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/C/">C++</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Kaggle/">Kaggle</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Keras/">Keras</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NLTK基础教程/">NLTK基础教程</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PHP/">PHP</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/leetcode/">leetcode</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/scrapy/">scrapy</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/实验教程/">实验教程</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/文本分类/">文本分类</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/文本相似度/">文本相似度</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/深度学习/">深度学习</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/笔记/">笔记</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/自然语言处理/">自然语言处理</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/资料/">资料</a><span class="tag-list-count">2</span></li></ul>
        </div>
    </div>


            
                
    <div class="widget-wrap widget-float">
        <h3 class="widget-title">标签云</h3>
        <div class="widget tagcloud">
            <a href="/tags/C/" style="font-size: 10px;">C++</a> <a href="/tags/Kaggle/" style="font-size: 16.67px;">Kaggle</a> <a href="/tags/Keras/" style="font-size: 10px;">Keras</a> <a href="/tags/NLTK基础教程/" style="font-size: 16.67px;">NLTK基础教程</a> <a href="/tags/PHP/" style="font-size: 10px;">PHP</a> <a href="/tags/leetcode/" style="font-size: 10px;">leetcode</a> <a href="/tags/python/" style="font-size: 13.33px;">python</a> <a href="/tags/scrapy/" style="font-size: 13.33px;">scrapy</a> <a href="/tags/实验教程/" style="font-size: 20px;">实验教程</a> <a href="/tags/文本分类/" style="font-size: 16.67px;">文本分类</a> <a href="/tags/文本相似度/" style="font-size: 10px;">文本相似度</a> <a href="/tags/深度学习/" style="font-size: 10px;">深度学习</a> <a href="/tags/笔记/" style="font-size: 10px;">笔记</a> <a href="/tags/自然语言处理/" style="font-size: 20px;">自然语言处理</a> <a href="/tags/资料/" style="font-size: 13.33px;">资料</a>
        </div>
    </div>


            
                
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">链接</h3>
        <div class="widget">
            <ul>
                
                    <li>
                        <a href="http://study.163.com/course/courseMain.htm?courseId=1005638005">Online Course</a>
                    </li>
                
            </ul>
        </div>
    </div>


            
        
    </div>
</aside>

                </div>
            </div>
        </div>
        <footer id="footer">
    <div class="container">
        <div class="container-inner">
            <a id="back-to-top" href="javascript:;"><i class="icon fa fa-angle-up"></i></a>
            <div class="credit">
                <h1 class="logo-wrap">
                    <a href="/" class="logo"></a>
                </h1>
                <p>&copy; 2018 IrvingBei</p>
                <p>Powered by <a href="//hexo.io/" target="_blank">Hexo</a>. Theme by <a href="//github.com/ppoffice" target="_blank">PPOffice</a></p>
            </div>
            <div class="footer-plugins">
              
    


            </div>
        </div>
    </div>
</footer>

        
    
    <script id="cy_cmt_num" src="https://changyan.sohu.com/upload/plugins/plugins.list.count.js?clientId=cytocN1SG"></script>
    <script type="text/javascript">
        (function() {
            var appid = 'cytocN1SG';
            var conf = '6a5712782fd0d61668873ebb581285ce';
            var width = window.innerWidth || document.documentElement.clientWidth;
            if (width < 960) {
                window.document.write('<script id="changyan_mobile_js" charset="utf-8" type="text/javascript" src="https://changyan.sohu.com/upload/mobile/wap-js/changyan_mobile.js?client_id=' + appid + '&conf=' + conf + '"><\/script>');
            } else {
                var loadJs = function(d, a) {
                    var c = document.getElementsByTagName("head")[0] || document.head || document.documentElement;
                    var b = document.createElement("script");
                    b.setAttribute("type", "text/javascript");
                    b.setAttribute("charset", "UTF-8");
                    b.setAttribute("src", d);
                    if (typeof a === "function") {
                        if (window.attachEvent) {
                            b.onreadystatechange = function() {
                                var e = b.readyState;
                                if (e === "loaded" || e === "complete") {
                                    b.onreadystatechange = null;
                                    a()
                                }
                            }
                        } else {
                            b.onload = a
                        }
                    }
                    c.appendChild(b)
                };
                loadJs("https://changyan.sohu.com/upload/changyan.js", function() {
                    window.changyan.api.config({
                        appid: appid,
                        conf: conf
                    })
                });
            }
        })();
    </script>





    
        <script src="/libs/lightgallery/js/lightgallery.min.js"></script>
        <script src="/libs/lightgallery/js/lg-thumbnail.min.js"></script>
        <script src="/libs/lightgallery/js/lg-pager.min.js"></script>
        <script src="/libs/lightgallery/js/lg-autoplay.min.js"></script>
        <script src="/libs/lightgallery/js/lg-fullscreen.min.js"></script>
        <script src="/libs/lightgallery/js/lg-zoom.min.js"></script>
        <script src="/libs/lightgallery/js/lg-hash.min.js"></script>
        <script src="/libs/lightgallery/js/lg-share.min.js"></script>
        <script src="/libs/lightgallery/js/lg-video.min.js"></script>
    
    
        <script src="/libs/justified-gallery/jquery.justifiedGallery.min.js"></script>
    
    



<!-- Custom Scripts -->
<script src="/js/main.js"></script>

    </div>
</body>
</html>

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />

    

    
    <title>Bag of Words Meets Bags of Popcorn(3)-Word2Voc | 山不过来，我就过去</title>
    
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
        <meta name="keywords" content="Kaggle,文本分类" />
    
    <meta name="description" content="词带模型：Bag of Words Meets Bags of Popcorn(1)-Bag of WordsTfidf模型：Bag of Words Meets Bags of Popcorn(2)-tfidf这一节采用词向量">
<meta name="keywords" content="Kaggle,文本分类">
<meta property="og:type" content="article">
<meta property="og:title" content="Bag of Words Meets Bags of Popcorn(3)-Word2Voc">
<meta property="og:url" content="http://yoursite.com/2018/06/14/Bag of Words Meets Bags of Popcorn(3)-Word2Voc (1)/index.html">
<meta property="og:site_name" content="山不过来，我就过去">
<meta property="og:description" content="词带模型：Bag of Words Meets Bags of Popcorn(1)-Bag of WordsTfidf模型：Bag of Words Meets Bags of Popcorn(2)-tfidf这一节采用词向量">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2018-06-14T09:28:51.515Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Bag of Words Meets Bags of Popcorn(3)-Word2Voc">
<meta name="twitter:description" content="词带模型：Bag of Words Meets Bags of Popcorn(1)-Bag of WordsTfidf模型：Bag of Words Meets Bags of Popcorn(2)-tfidf这一节采用词向量">
    

    
        <link rel="alternate" href="/" title="山不过来，我就过去" type="application/atom+xml" />
    

    

    <link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="/libs/titillium-web/styles.css">
    <link rel="stylesheet" href="/libs/source-code-pro/styles.css">

    <link rel="stylesheet" href="/css/style.css">

    <script src="/libs/jquery/3.3.1/jquery.min.js"></script>
    
    
        <link rel="stylesheet" href="/libs/lightgallery/css/lightgallery.min.css">
    
    
        <link rel="stylesheet" href="/libs/justified-gallery/justifiedGallery.min.css">
    
    
    


</head>

<body>
    <div id="wrap">
        <header id="header">
    <div id="header-outer" class="outer">
        <div class="container">
            <div class="container-inner">
                <div id="header-title">
                    <h1 class="logo-wrap">
                        <a href="/" class="logo"></a>
                    </h1>
                    
                        <h2 class="subtitle-wrap">
                            <p class="subtitle">保持学习的态度！</p>
                        </h2>
                    
                </div>
                <div id="header-inner" class="nav-container">
                    <a id="main-nav-toggle" class="nav-icon fa fa-bars"></a>
                    <div class="nav-container-inner">
                        <ul id="main-nav">
                            
                                <li class="main-nav-list-item" >
                                    <a class="main-nav-list-link" href="/">主页</a>
                                </li>
                            
                                <li class="main-nav-list-item" >
                                    <a class="main-nav-list-link" href="/photos/">index.photos</a>
                                </li>
                            
                        </ul>
                        <nav id="sub-nav">
                            <div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="搜索" />
        <button type="submit" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="想要查找什么..." />
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(未命名)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js"></script>

</div>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
    </div>
</header>
        <div class="container">
            <div class="main-body container-inner">
                <div class="main-body-inner">
                    <section id="main">
                        <div class="main-body-header">
    <h1 class="header">
    
    未分类
    </h1>
</div>
                        <div class="main-body-content">
                            <article id="post-Bag of Words Meets Bags of Popcorn(3)-Word2Voc (1)" class="article article-single article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
            <header class="article-header">
                
    
        <h1 class="article-title" itemprop="name">
        Bag of Words Meets Bags of Popcorn(3)-Word2Voc
        </h1>
    

            </header>
        
        
            <div class="article-meta">
                
    <div class="article-date">
        <a href="/2018/06/14/Bag of Words Meets Bags of Popcorn(3)-Word2Voc (1)/" class="article-date">
            <time datetime="2018-06-14T09:27:51.000Z" itemprop="datePublished">2018-06-14</time>
        </a>
    </div>

                
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/Kaggle/">Kaggle</a>, <a class="tag-link" href="/tags/文本分类/">文本分类</a>
    </div>

            </div>
        
        
        <div class="article-entry" itemprop="articleBody">
            <p>词带模型：<a href="http://bei.dreamcykj.com/2018/06/13/Bag%20of%20Words%20Meets%20Bags%20of%20Popcorn%281%29-Bag%20of%20Words/" target="_blank" rel="noopener">Bag of Words Meets Bags of Popcorn(1)-Bag of Words</a><br>Tfidf模型：<a href="http://bei.dreamcykj.com/2018/06/14/Bag%20of%20Words%20Meets%20Bags%20of%20Popcorn%282%29-tfidf%20%281%29/" target="_blank" rel="noopener">Bag of Words Meets Bags of Popcorn(2)-tfidf</a><br>这一节采用词向量<br><a id="more"></a></p>
<h4 id="1、读取数据"><a href="#1、读取数据" class="headerlink" title="1、读取数据"></a>1、读取数据</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">train=pd.read_csv(<span class="string">'./data/labeledTrainData.tsv'</span>,header=<span class="number">0</span>,delimiter=<span class="string">"\t"</span>,quoting=<span class="number">3</span>)</span><br><span class="line">test=pd.read_csv(<span class="string">"./data/testData.tsv"</span>,header=<span class="number">0</span>,delimiter=<span class="string">"\t"</span>,quoting=<span class="number">3</span>)</span><br><span class="line">unlabeled_train=pd.read_csv(<span class="string">"./data/unlabeledTrainData.tsv"</span>,header=<span class="number">0</span>,delimiter=<span class="string">"\t"</span>,quoting=<span class="number">3</span>)</span><br><span class="line"><span class="comment"># 查看数据的大小</span></span><br><span class="line">print(<span class="string">"read %d labeled train reviews,%d labeled test reviews and %d unlabeled reviews\n"</span>%(train[<span class="string">"review"</span>].size,len(test),len(unlabeled_train)))</span><br></pre></td></tr></table></figure>
<pre><code>read 25000 labeled train reviews,25000 labeled test reviews and 50000 unlabeled reviews
</code></pre><h4 id="2、数据清洗"><a href="#2、数据清洗" class="headerlink" title="2、数据清洗"></a>2、数据清洗</h4><h5 id="2、1-对每一句评论进行数据清洗"><a href="#2、1-对每一句评论进行数据清洗" class="headerlink" title="2、1 对每一句评论进行数据清洗"></a>2、1 对每一句评论进行数据清洗</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> re </span><br><span class="line"><span class="keyword">from</span> nltk.corpus <span class="keyword">import</span> stopwords</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">review_to_wordlist</span><span class="params">(review,remove_stopwords=False)</span>:</span></span><br><span class="line">    <span class="comment"># 去掉html标签</span></span><br><span class="line">    review_text=BeautifulSoup(review).get_text()</span><br><span class="line">    <span class="comment"># 去掉标点符号和非法字符</span></span><br><span class="line">    review_text=re.sub(<span class="string">"[^a-zA-Z]"</span>,<span class="string">" "</span>,review_text)</span><br><span class="line">    <span class="comment"># 全部转化为小写,并以空格分割</span></span><br><span class="line">    words=review_text.lower().split()</span><br><span class="line">    <span class="comment"># 去停用词</span></span><br><span class="line">    <span class="keyword">if</span> remove_stopwords:</span><br><span class="line">        stops=set(stopwords.words(<span class="string">"english"</span>))</span><br><span class="line">        words=[w <span class="keyword">for</span> w <span class="keyword">in</span> words <span class="keyword">if</span> w <span class="keyword">not</span> <span class="keyword">in</span> stops]</span><br><span class="line">    <span class="keyword">return</span> words</span><br></pre></td></tr></table></figure>
<h5 id="2-2-对每一篇评论进行数据清洗"><a href="#2-2-对每一篇评论进行数据清洗" class="headerlink" title="2.2 对每一篇评论进行数据清洗"></a>2.2 对每一篇评论进行数据清洗</h5><p>将评论段落转换为句子，返回句子列表，每个句子由一堆词组成</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> nltk.data</span><br><span class="line">tokenizer=nltk.data.load(<span class="string">"tokenizers/punkt/english.pickle"</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">review_to_sentences</span><span class="params">(review,tokenizer,remove_stopwords=False)</span>:</span></span><br><span class="line">    <span class="comment"># 将评论按句子分割</span></span><br><span class="line">    raw_sentences=tokenizer.tokenize(review.strip())</span><br><span class="line">    <span class="comment"># 对一个评论的每一句话进行清洗</span></span><br><span class="line">    sentences=[]</span><br><span class="line">    <span class="keyword">for</span> raw_sentence <span class="keyword">in</span> raw_sentences:</span><br><span class="line">        <span class="keyword">if</span> len(raw_sentence)&gt;<span class="number">0</span>:</span><br><span class="line">            <span class="comment"># 调用数据清洗方法，对该句评论进行清洗</span></span><br><span class="line">            sentences.append(review_to_wordlist(raw_sentence,remove_stopwords))</span><br><span class="line">    <span class="comment"># 返回清洗后的这一篇评论</span></span><br><span class="line">    <span class="keyword">return</span> sentences</span><br></pre></td></tr></table></figure>
<h4 id="3、构造语料集"><a href="#3、构造语料集" class="headerlink" title="3、构造语料集"></a>3、构造语料集</h4><p>语料集中的数据包括已标注好的训练集和未标注好的训练集</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">sentences=[] <span class="comment"># 装有所有评论数据的一个list，相当于一个语料集,格式为：[[a.b.c].[a.b.c.d]...]</span></span><br><span class="line">print(<span class="string">"Parsing sentences from training set"</span>)</span><br><span class="line"><span class="keyword">for</span> review <span class="keyword">in</span> train[<span class="string">"review"</span>]:</span><br><span class="line">    sentences+=review_to_sentences(review,tokenizer)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"Parsing sentence from unlabeled set"</span>)</span><br><span class="line"><span class="keyword">for</span> review <span class="keyword">in</span> unlabeled_train[<span class="string">"review"</span>]:</span><br><span class="line">    sentences+=review_to_sentences(review,tokenizer)</span><br><span class="line"><span class="comment"># 查看语料集的大小</span></span><br><span class="line">print(len(sentences))</span><br></pre></td></tr></table></figure>
<pre><code>Parsing sentences from training set
795538
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看部分数据</span></span><br><span class="line">print(sentences[<span class="number">0</span>])</span><br><span class="line">print(sentences[<span class="number">1</span>])</span><br></pre></td></tr></table></figure>
<pre><code>[&apos;with&apos;, &apos;all&apos;, &apos;this&apos;, &apos;stuff&apos;, &apos;going&apos;, &apos;down&apos;, &apos;at&apos;, &apos;the&apos;, &apos;moment&apos;, &apos;with&apos;, &apos;mj&apos;, &apos;i&apos;, &apos;ve&apos;, &apos;started&apos;, &apos;listening&apos;, &apos;to&apos;, &apos;his&apos;, &apos;music&apos;, &apos;watching&apos;, &apos;the&apos;, &apos;odd&apos;, &apos;documentary&apos;, &apos;here&apos;, &apos;and&apos;, &apos;there&apos;, &apos;watched&apos;, &apos;the&apos;, &apos;wiz&apos;, &apos;and&apos;, &apos;watched&apos;, &apos;moonwalker&apos;, &apos;again&apos;]
[&apos;maybe&apos;, &apos;i&apos;, &apos;just&apos;, &apos;want&apos;, &apos;to&apos;, &apos;get&apos;, &apos;a&apos;, &apos;certain&apos;, &apos;insight&apos;, &apos;into&apos;, &apos;this&apos;, &apos;guy&apos;, &apos;who&apos;, &apos;i&apos;, &apos;thought&apos;, &apos;was&apos;, &apos;really&apos;, &apos;cool&apos;, &apos;in&apos;, &apos;the&apos;, &apos;eighties&apos;, &apos;just&apos;, &apos;to&apos;, &apos;maybe&apos;, &apos;make&apos;, &apos;up&apos;, &apos;my&apos;, &apos;mind&apos;, &apos;whether&apos;, &apos;he&apos;, &apos;is&apos;, &apos;guilty&apos;, &apos;or&apos;, &apos;innocent&apos;]
</code></pre><h4 id="4、构建word2vec模型"><a href="#4、构建word2vec模型" class="headerlink" title="4、构建word2vec模型"></a>4、构建word2vec模型</h4><p>这里主要使用gensim里的word2vec，相关介绍和使用情况见：python︱gensim训练word2vec及相关函数与功能理解 <a href="https://blog.csdn.net/sinat_26917383/article/details/69803018" target="_blank" rel="noopener">https://blog.csdn.net/sinat_26917383/article/details/69803018</a></p>
<h5 id="4、1训练模型"><a href="#4、1训练模型" class="headerlink" title="4、1训练模型"></a>4、1训练模型</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gensim,logging</span><br><span class="line">logging.basicConfig(format=<span class="string">"%(asctime)s : %(levelname)s : %(message)s"</span>,level=logging.INFO)</span><br><span class="line"></span><br><span class="line">num_features=<span class="number">300</span></span><br><span class="line">min_word_count=<span class="number">40</span></span><br><span class="line">num_workers=<span class="number">4</span></span><br><span class="line">context=<span class="number">10</span></span><br><span class="line">downsampling=<span class="number">1e-3</span></span><br><span class="line">print(<span class="string">"Training model..."</span>)</span><br><span class="line">model=gensim.models.Word2Vec(sentences,workers=num_workers,size=num_features,min_count=min_word_count,window=context,sample=downsampling)</span><br><span class="line">model.init_sims(replace=<span class="keyword">True</span>)</span><br><span class="line">model_name=<span class="string">"300features_40minwords_10context"</span></span><br><span class="line">model.save(<span class="string">"./data/"</span>+model_name)</span><br></pre></td></tr></table></figure>
<pre><code>2018-06-14 16:17:04,394 : INFO : collecting all words and their counts
2018-06-14 16:17:04,394 : INFO : PROGRESS: at sentence #0, processed 0 words, keeping 0 word types
2018-06-14 16:17:04,439 : INFO : PROGRESS: at sentence #10000, processed 225803 words, keeping 17776 word types
2018-06-14 16:17:04,486 : INFO : PROGRESS: at sentence #20000, processed 451892 words, keeping 24948 word types
2018-06-14 16:17:04,530 : INFO : PROGRESS: at sentence #30000, processed 671315 words, keeping 30034 word types
2018-06-14 16:17:04,576 : INFO : PROGRESS: at sentence #40000, processed 897815 words, keeping 34348 word types


Training model...


2018-06-14 16:17:04,621 : INFO : PROGRESS: at sentence #50000, processed 1116963 words, keeping 37761 word types
2018-06-14 16:17:04,666 : INFO : PROGRESS: at sentence #60000, processed 1338404 words, keeping 40723 word types
2018-06-14 16:17:04,711 : INFO : PROGRESS: at sentence #70000, processed 1561580 words, keeping 43333 word types
2018-06-14 16:17:04,759 : INFO : PROGRESS: at sentence #80000, processed 1780887 words, keeping 45714 word types
2018-06-14 16:17:04,804 : INFO : PROGRESS: at sentence #90000, processed 2004996 words, keeping 48135 word types
2018-06-14 16:17:04,849 : INFO : PROGRESS: at sentence #100000, processed 2226966 words, keeping 50207 word types
2018-06-14 16:17:04,894 : INFO : PROGRESS: at sentence #110000, processed 2446580 words, keeping 52081 word types
2018-06-14 16:17:04,939 : INFO : PROGRESS: at sentence #120000, processed 2668775 words, keeping 54119 word types
2018-06-14 16:17:04,985 : INFO : PROGRESS: at sentence #130000, processed 2894303 words, keeping 55847 word types
2018-06-14 16:17:05,029 : INFO : PROGRESS: at sentence #140000, processed 3107005 words, keeping 57346 word types
2018-06-14 16:17:05,075 : INFO : PROGRESS: at sentence #150000, processed 3332627 words, keeping 59055 word types
2018-06-14 16:17:05,120 : INFO : PROGRESS: at sentence #160000, processed 3555315 words, keeping 60617 word types
2018-06-14 16:17:05,166 : INFO : PROGRESS: at sentence #170000, processed 3778655 words, keeping 62077 word types
2018-06-14 16:17:05,212 : INFO : PROGRESS: at sentence #180000, processed 3999236 words, keeping 63496 word types
2018-06-14 16:17:05,258 : INFO : PROGRESS: at sentence #190000, processed 4224449 words, keeping 64794 word types
2018-06-14 16:17:05,304 : INFO : PROGRESS: at sentence #200000, processed 4448603 words, keeping 66087 word types
2018-06-14 16:17:05,350 : INFO : PROGRESS: at sentence #210000, processed 4669967 words, keeping 67390 word types
2018-06-14 16:17:05,397 : INFO : PROGRESS: at sentence #220000, processed 4894968 words, keeping 68697 word types
2018-06-14 16:17:05,443 : INFO : PROGRESS: at sentence #230000, processed 5117545 words, keeping 69958 word types
2018-06-14 16:17:05,490 : INFO : PROGRESS: at sentence #240000, processed 5345050 words, keeping 71167 word types
2018-06-14 16:17:05,535 : INFO : PROGRESS: at sentence #250000, processed 5559165 words, keeping 72351 word types
2018-06-14 16:17:05,581 : INFO : PROGRESS: at sentence #260000, processed 5779146 words, keeping 73478 word types
2018-06-14 16:17:05,627 : INFO : PROGRESS: at sentence #270000, processed 6000435 words, keeping 74767 word types
2018-06-14 16:17:05,674 : INFO : PROGRESS: at sentence #280000, processed 6226314 words, keeping 76369 word types
2018-06-14 16:17:05,720 : INFO : PROGRESS: at sentence #290000, processed 6449474 words, keeping 77839 word types
2018-06-14 16:17:05,767 : INFO : PROGRESS: at sentence #300000, processed 6674077 words, keeping 79171 word types
2018-06-14 16:17:05,814 : INFO : PROGRESS: at sentence #310000, processed 6899391 words, keeping 80480 word types
2018-06-14 16:17:05,861 : INFO : PROGRESS: at sentence #320000, processed 7124278 words, keeping 81808 word types
2018-06-14 16:17:05,908 : INFO : PROGRESS: at sentence #330000, processed 7346021 words, keeping 83030 word types
2018-06-14 16:17:05,956 : INFO : PROGRESS: at sentence #340000, processed 7575533 words, keeping 84280 word types
2018-06-14 16:17:06,002 : INFO : PROGRESS: at sentence #350000, processed 7798803 words, keeping 85425 word types
2018-06-14 16:17:06,048 : INFO : PROGRESS: at sentence #360000, processed 8019427 words, keeping 86596 word types
2018-06-14 16:17:06,100 : INFO : PROGRESS: at sentence #370000, processed 8246619 words, keeping 87708 word types
2018-06-14 16:17:06,146 : INFO : PROGRESS: at sentence #380000, processed 8471766 words, keeping 88878 word types
2018-06-14 16:17:06,194 : INFO : PROGRESS: at sentence #390000, processed 8701497 words, keeping 89907 word types
2018-06-14 16:17:06,240 : INFO : PROGRESS: at sentence #400000, processed 8924446 words, keeping 90916 word types
2018-06-14 16:17:06,286 : INFO : PROGRESS: at sentence #410000, processed 9145796 words, keeping 91880 word types
2018-06-14 16:17:06,331 : INFO : PROGRESS: at sentence #420000, processed 9366876 words, keeping 92912 word types
2018-06-14 16:17:06,378 : INFO : PROGRESS: at sentence #430000, processed 9594413 words, keeping 93932 word types
2018-06-14 16:17:06,425 : INFO : PROGRESS: at sentence #440000, processed 9821166 words, keeping 94906 word types
2018-06-14 16:17:06,471 : INFO : PROGRESS: at sentence #450000, processed 10044928 words, keeping 96036 word types
2018-06-14 16:17:06,519 : INFO : PROGRESS: at sentence #460000, processed 10277688 words, keeping 97088 word types
2018-06-14 16:17:06,566 : INFO : PROGRESS: at sentence #470000, processed 10505613 words, keeping 97933 word types
2018-06-14 16:17:06,612 : INFO : PROGRESS: at sentence #480000, processed 10725997 words, keeping 98862 word types
2018-06-14 16:17:06,659 : INFO : PROGRESS: at sentence #490000, processed 10952741 words, keeping 99871 word types
2018-06-14 16:17:06,704 : INFO : PROGRESS: at sentence #500000, processed 11174397 words, keeping 100765 word types
2018-06-14 16:17:06,752 : INFO : PROGRESS: at sentence #510000, processed 11399672 words, keeping 101699 word types
2018-06-14 16:17:06,798 : INFO : PROGRESS: at sentence #520000, processed 11623020 words, keeping 102598 word types
2018-06-14 16:17:06,845 : INFO : PROGRESS: at sentence #530000, processed 11847418 words, keeping 103400 word types
2018-06-14 16:17:06,893 : INFO : PROGRESS: at sentence #540000, processed 12072033 words, keeping 104265 word types
2018-06-14 16:17:06,942 : INFO : PROGRESS: at sentence #550000, processed 12297571 words, keeping 105133 word types
2018-06-14 16:17:06,990 : INFO : PROGRESS: at sentence #560000, processed 12518861 words, keeping 105997 word types
2018-06-14 16:17:07,040 : INFO : PROGRESS: at sentence #570000, processed 12747916 words, keeping 106787 word types
2018-06-14 16:17:07,089 : INFO : PROGRESS: at sentence #580000, processed 12969412 words, keeping 107665 word types
2018-06-14 16:17:07,138 : INFO : PROGRESS: at sentence #590000, processed 13194937 words, keeping 108501 word types
2018-06-14 16:17:07,197 : INFO : PROGRESS: at sentence #600000, processed 13417135 words, keeping 109218 word types
2018-06-14 16:17:07,245 : INFO : PROGRESS: at sentence #610000, processed 13638158 words, keeping 110092 word types
2018-06-14 16:17:07,294 : INFO : PROGRESS: at sentence #620000, processed 13864483 words, keeping 110837 word types
2018-06-14 16:17:07,343 : INFO : PROGRESS: at sentence #630000, processed 14088769 words, keeping 111610 word types
2018-06-14 16:17:07,392 : INFO : PROGRESS: at sentence #640000, processed 14309552 words, keeping 112416 word types
2018-06-14 16:17:07,441 : INFO : PROGRESS: at sentence #650000, processed 14535308 words, keeping 113196 word types
2018-06-14 16:17:07,490 : INFO : PROGRESS: at sentence #660000, processed 14758098 words, keeping 113945 word types
2018-06-14 16:17:07,538 : INFO : PROGRESS: at sentence #670000, processed 14981482 words, keeping 114643 word types
2018-06-14 16:17:07,587 : INFO : PROGRESS: at sentence #680000, processed 15206314 words, keeping 115354 word types
2018-06-14 16:17:07,636 : INFO : PROGRESS: at sentence #690000, processed 15428507 words, keeping 116131 word types
2018-06-14 16:17:07,686 : INFO : PROGRESS: at sentence #700000, processed 15657213 words, keeping 116943 word types
2018-06-14 16:17:07,732 : INFO : PROGRESS: at sentence #710000, processed 15880202 words, keeping 117596 word types
2018-06-14 16:17:07,779 : INFO : PROGRESS: at sentence #720000, processed 16105489 words, keeping 118221 word types
2018-06-14 16:17:07,826 : INFO : PROGRESS: at sentence #730000, processed 16331870 words, keeping 118954 word types
2018-06-14 16:17:07,872 : INFO : PROGRESS: at sentence #740000, processed 16552903 words, keeping 119668 word types
2018-06-14 16:17:07,918 : INFO : PROGRESS: at sentence #750000, processed 16771230 words, keeping 120295 word types
2018-06-14 16:17:07,964 : INFO : PROGRESS: at sentence #760000, processed 16990622 words, keeping 120930 word types
2018-06-14 16:17:08,012 : INFO : PROGRESS: at sentence #770000, processed 17217759 words, keeping 121703 word types
2018-06-14 16:17:08,060 : INFO : PROGRESS: at sentence #780000, processed 17447905 words, keeping 122402 word types
2018-06-14 16:17:08,108 : INFO : PROGRESS: at sentence #790000, processed 17674981 words, keeping 123066 word types
2018-06-14 16:17:08,134 : INFO : collected 123504 word types from a corpus of 17798082 raw words and 795538 sentences
2018-06-14 16:17:08,134 : INFO : Loading a fresh vocabulary
2018-06-14 16:17:08,204 : INFO : min_count=40 retains 16490 unique words (13% of original 123504, drops 107014)
2018-06-14 16:17:08,205 : INFO : min_count=40 leaves 17238940 word corpus (96% of original 17798082, drops 559142)
2018-06-14 16:17:08,247 : INFO : deleting the raw counts dictionary of 123504 items
2018-06-14 16:17:08,249 : INFO : sample=0.001 downsamples 48 most-common words
2018-06-14 16:17:08,250 : INFO : downsampling leaves estimated 12749658 word corpus (74.0% of prior 17238940)
2018-06-14 16:17:08,286 : INFO : estimated required memory for 16490 words and 300 dimensions: 47821000 bytes
2018-06-14 16:17:08,286 : INFO : resetting layer weights
2018-06-14 16:17:08,497 : INFO : training model with 4 workers on 16490 vocabulary and 300 features, using sg=0 hs=0 sample=0.001 negative=5 window=10
2018-06-14 16:17:09,516 : INFO : EPOCH 1 - PROGRESS: at 6.40% examples, 812589 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:10,525 : INFO : EPOCH 1 - PROGRESS: at 13.20% examples, 832030 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:11,526 : INFO : EPOCH 1 - PROGRESS: at 20.16% examples, 847270 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:12,529 : INFO : EPOCH 1 - PROGRESS: at 27.14% examples, 856397 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:13,535 : INFO : EPOCH 1 - PROGRESS: at 34.33% examples, 865561 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:14,549 : INFO : EPOCH 1 - PROGRESS: at 41.21% examples, 865831 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:15,556 : INFO : EPOCH 1 - PROGRESS: at 48.00% examples, 866028 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:16,560 : INFO : EPOCH 1 - PROGRESS: at 55.16% examples, 871678 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:17,561 : INFO : EPOCH 1 - PROGRESS: at 62.03% examples, 873356 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:18,569 : INFO : EPOCH 1 - PROGRESS: at 70.05% examples, 887453 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:19,574 : INFO : EPOCH 1 - PROGRESS: at 78.55% examples, 905131 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:20,576 : INFO : EPOCH 1 - PROGRESS: at 87.08% examples, 920073 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:21,580 : INFO : EPOCH 1 - PROGRESS: at 95.30% examples, 929252 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:22,257 : INFO : worker thread finished; awaiting finish of 3 more threads
2018-06-14 16:17:22,269 : INFO : worker thread finished; awaiting finish of 2 more threads
2018-06-14 16:17:22,279 : INFO : worker thread finished; awaiting finish of 1 more threads
2018-06-14 16:17:22,283 : INFO : worker thread finished; awaiting finish of 0 more threads
2018-06-14 16:17:22,284 : INFO : EPOCH - 1 : training on 17798082 raw words (12749777 effective words) took 13.8s, 925879 effective words/s
2018-06-14 16:17:23,304 : INFO : EPOCH 2 - PROGRESS: at 8.00% examples, 1007006 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:24,312 : INFO : EPOCH 2 - PROGRESS: at 16.61% examples, 1043247 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:25,319 : INFO : EPOCH 2 - PROGRESS: at 24.73% examples, 1036444 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:26,323 : INFO : EPOCH 2 - PROGRESS: at 31.73% examples, 997990 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:27,344 : INFO : EPOCH 2 - PROGRESS: at 38.79% examples, 974442 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:28,345 : INFO : EPOCH 2 - PROGRESS: at 45.83% examples, 962075 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:29,345 : INFO : EPOCH 2 - PROGRESS: at 52.83% examples, 952391 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:30,351 : INFO : EPOCH 2 - PROGRESS: at 59.61% examples, 942736 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:31,357 : INFO : EPOCH 2 - PROGRESS: at 66.74% examples, 938270 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:32,357 : INFO : EPOCH 2 - PROGRESS: at 73.62% examples, 932470 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:33,366 : INFO : EPOCH 2 - PROGRESS: at 80.53% examples, 926935 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:34,378 : INFO : EPOCH 2 - PROGRESS: at 87.08% examples, 918591 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:35,390 : INFO : EPOCH 2 - PROGRESS: at 94.27% examples, 917532 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:36,174 : INFO : worker thread finished; awaiting finish of 3 more threads
2018-06-14 16:17:36,183 : INFO : worker thread finished; awaiting finish of 2 more threads
2018-06-14 16:17:36,192 : INFO : worker thread finished; awaiting finish of 1 more threads
2018-06-14 16:17:36,192 : INFO : worker thread finished; awaiting finish of 0 more threads
2018-06-14 16:17:36,193 : INFO : EPOCH - 2 : training on 17798082 raw words (12750854 effective words) took 13.9s, 917479 effective words/s
2018-06-14 16:17:37,202 : INFO : EPOCH 3 - PROGRESS: at 7.77% examples, 984985 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:38,212 : INFO : EPOCH 3 - PROGRESS: at 16.44% examples, 1034693 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:39,216 : INFO : EPOCH 3 - PROGRESS: at 25.10% examples, 1055381 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:40,227 : INFO : EPOCH 3 - PROGRESS: at 33.83% examples, 1063504 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:41,229 : INFO : EPOCH 3 - PROGRESS: at 42.30% examples, 1067870 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:42,236 : INFO : EPOCH 3 - PROGRESS: at 50.79% examples, 1069786 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:43,243 : INFO : EPOCH 3 - PROGRESS: at 59.22% examples, 1071100 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:44,251 : INFO : EPOCH 3 - PROGRESS: at 67.75% examples, 1071922 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:45,253 : INFO : EPOCH 3 - PROGRESS: at 76.27% examples, 1073438 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:46,257 : INFO : EPOCH 3 - PROGRESS: at 84.78% examples, 1074300 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:47,261 : INFO : EPOCH 3 - PROGRESS: at 93.12% examples, 1073178 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:48,053 : INFO : worker thread finished; awaiting finish of 3 more threads
2018-06-14 16:17:48,059 : INFO : worker thread finished; awaiting finish of 2 more threads
2018-06-14 16:17:48,062 : INFO : worker thread finished; awaiting finish of 1 more threads
2018-06-14 16:17:48,071 : INFO : worker thread finished; awaiting finish of 0 more threads
2018-06-14 16:17:48,072 : INFO : EPOCH - 3 : training on 17798082 raw words (12748789 effective words) took 11.9s, 1073879 effective words/s
2018-06-14 16:17:49,091 : INFO : EPOCH 4 - PROGRESS: at 8.00% examples, 1005623 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:50,106 : INFO : EPOCH 4 - PROGRESS: at 16.61% examples, 1038972 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:51,116 : INFO : EPOCH 4 - PROGRESS: at 25.16% examples, 1051314 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:52,122 : INFO : EPOCH 4 - PROGRESS: at 33.77% examples, 1058149 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:53,133 : INFO : EPOCH 4 - PROGRESS: at 42.24% examples, 1061681 words/s, in_qsize 6, out_qsize 1
2018-06-14 16:17:54,141 : INFO : EPOCH 4 - PROGRESS: at 50.74% examples, 1064474 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:55,151 : INFO : EPOCH 4 - PROGRESS: at 59.17% examples, 1066074 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:56,161 : INFO : EPOCH 4 - PROGRESS: at 67.69% examples, 1067360 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:57,163 : INFO : EPOCH 4 - PROGRESS: at 75.94% examples, 1065426 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:58,166 : INFO : EPOCH 4 - PROGRESS: at 82.15% examples, 1038088 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:59,183 : INFO : EPOCH 4 - PROGRESS: at 88.92% examples, 1020976 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:18:00,189 : INFO : EPOCH 4 - PROGRESS: at 95.65% examples, 1006423 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:18:00,821 : INFO : worker thread finished; awaiting finish of 3 more threads
2018-06-14 16:18:00,829 : INFO : worker thread finished; awaiting finish of 2 more threads
2018-06-14 16:18:00,830 : INFO : worker thread finished; awaiting finish of 1 more threads
2018-06-14 16:18:00,833 : INFO : worker thread finished; awaiting finish of 0 more threads
2018-06-14 16:18:00,833 : INFO : EPOCH - 4 : training on 17798082 raw words (12749357 effective words) took 12.8s, 999843 effective words/s
2018-06-14 16:18:01,847 : INFO : EPOCH 5 - PROGRESS: at 8.11% examples, 1027303 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:18:02,858 : INFO : EPOCH 5 - PROGRESS: at 17.00% examples, 1069428 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:18:03,860 : INFO : EPOCH 5 - PROGRESS: at 25.86% examples, 1086074 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:18:04,863 : INFO : EPOCH 5 - PROGRESS: at 34.70% examples, 1093967 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:18:05,865 : INFO : EPOCH 5 - PROGRESS: at 43.30% examples, 1095208 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:18:06,868 : INFO : EPOCH 5 - PROGRESS: at 52.04% examples, 1097950 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:18:07,869 : INFO : EPOCH 5 - PROGRESS: at 60.69% examples, 1100176 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:18:08,878 : INFO : EPOCH 5 - PROGRESS: at 68.09% examples, 1079587 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:18:09,888 : INFO : EPOCH 5 - PROGRESS: at 74.91% examples, 1055508 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:18:10,900 : INFO : EPOCH 5 - PROGRESS: at 81.64% examples, 1034528 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:18:11,905 : INFO : EPOCH 5 - PROGRESS: at 88.40% examples, 1018906 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:18:12,916 : INFO : EPOCH 5 - PROGRESS: at 95.11% examples, 1004071 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:18:13,626 : INFO : worker thread finished; awaiting finish of 3 more threads
2018-06-14 16:18:13,635 : INFO : worker thread finished; awaiting finish of 2 more threads
2018-06-14 16:18:13,642 : INFO : worker thread finished; awaiting finish of 1 more threads
2018-06-14 16:18:13,643 : INFO : worker thread finished; awaiting finish of 0 more threads
2018-06-14 16:18:13,643 : INFO : EPOCH - 5 : training on 17798082 raw words (12749291 effective words) took 12.8s, 996145 effective words/s
2018-06-14 16:18:13,644 : INFO : training on a 88990410 raw words (63748068 effective words) took 65.1s, 978532 effective words/s
2018-06-14 16:18:13,645 : INFO : precomputing L2-norms of word weight vectors
2018-06-14 16:18:13,823 : INFO : saving Word2Vec object under ./data/300features_40minwords_10context, separately None
2018-06-14 16:18:13,824 : INFO : not storing attribute vectors_norm
2018-06-14 16:18:13,826 : INFO : not storing attribute cum_table
2018-06-14 16:18:14,267 : INFO : saved ./data/300features_40minwords_10context
</code></pre><h5 id="4、2-预览模型"><a href="#4、2-预览模型" class="headerlink" title="4、2 预览模型"></a>4、2 预览模型</h5><p>(1) 找出不匹配的词语</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">model.doesnt_match(<span class="string">"man woman child kitchen"</span>.split())</span><br></pre></td></tr></table></figure>
<pre><code>&apos;kitchen&apos;
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">model.doesnt_match(<span class="string">"france england germany berlin"</span>.split())</span><br></pre></td></tr></table></figure>
<pre><code>&apos;berlin&apos;
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">model.doesnt_match(<span class="string">"paris berlin london austria"</span>.split())</span><br></pre></td></tr></table></figure>
<pre><code>&apos;paris&apos;
</code></pre><p>(2)匹配相似的词</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">model.most_similar(<span class="string">"man"</span>)</span><br></pre></td></tr></table></figure>
<pre><code>[(&apos;woman&apos;, 0.6306251883506775),
 (&apos;lady&apos;, 0.5747369527816772),
 (&apos;lad&apos;, 0.5607120990753174),
 (&apos;farmer&apos;, 0.5333519577980042),
 (&apos;soldier&apos;, 0.5211611986160278),
 (&apos;businessman&apos;, 0.5164321660995483),
 (&apos;men&apos;, 0.514143705368042),
 (&apos;guy&apos;, 0.5132095813751221),
 (&apos;gentleman&apos;, 0.5126838088035583),
 (&apos;chap&apos;, 0.5047199130058289)]
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">model.most_similar(<span class="string">"queen"</span>)</span><br></pre></td></tr></table></figure>
<pre><code>[(&apos;princess&apos;, 0.665077805519104),
 (&apos;belle&apos;, 0.6354636549949646),
 (&apos;bride&apos;, 0.6334044933319092),
 (&apos;stepmother&apos;, 0.6092513799667358),
 (&apos;victoria&apos;, 0.603207528591156),
 (&apos;maid&apos;, 0.5809364318847656),
 (&apos;angela&apos;, 0.5791389346122742),
 (&apos;showgirl&apos;, 0.5766100883483887),
 (&apos;seductress&apos;, 0.576302170753479),
 (&apos;maria&apos;, 0.5733033418655396)]
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">model.most_similar(<span class="string">"awful"</span>)</span><br></pre></td></tr></table></figure>
<pre><code>[(&apos;terrible&apos;, 0.7602646350860596),
 (&apos;atrocious&apos;, 0.7441849708557129),
 (&apos;horrible&apos;, 0.7187424898147583),
 (&apos;abysmal&apos;, 0.7162792682647705),
 (&apos;dreadful&apos;, 0.6996028423309326),
 (&apos;appalling&apos;, 0.6916007995605469),
 (&apos;horrendous&apos;, 0.6912209987640381),
 (&apos;horrid&apos;, 0.6631687879562378),
 (&apos;lousy&apos;, 0.6283937692642212),
 (&apos;amateurish&apos;, 0.616948127746582)]
</code></pre><p>（3）查看模型内部词向量内容</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">model[<span class="string">'flower'</span>]</span><br></pre></td></tr></table></figure>
<pre><code>array([-0.04672493,  0.08882798, -0.00798039,  0.01940776,  0.00703776,
       -0.0983417 , -0.03383616,  0.01253733,  0.1013744 , -0.06382444,
        0.05575086, -0.03603694, -0.1734672 , -0.10947284,  0.04083061,
       -0.02300067, -0.08912303, -0.01208846, -0.03741381, -0.03776918,
        0.00958646, -0.04842193,  0.03746754,  0.00568479, -0.03371157,
        0.05098233,  0.03344997, -0.04607128, -0.03911143, -0.09323646,
        0.05823594,  0.05683371, -0.03013518,  0.03097427,  0.02941879,
        0.05783584,  0.02902247,  0.02647943, -0.04254698, -0.01946488,
       -0.07041467,  0.07577515,  0.01416771,  0.06094591,  0.05511365,
        0.02002226, -0.09548184,  0.01083773,  0.11513695, -0.00510942,
        0.10982258,  0.0311219 , -0.11257961, -0.04740267,  0.02418482,
       -0.13684008, -0.01806154, -0.03081693, -0.02723986, -0.02626858,
       -0.02271062,  0.02877414, -0.18940935,  0.15113354, -0.08325452,
        0.13035862,  0.03562083,  0.05715419,  0.05659889,  0.11132292,
       -0.11618023, -0.02525528, -0.04214492, -0.01676722, -0.11387489,
        0.01289947,  0.06157506,  0.02216116,  0.03087287,  0.00053991,
        0.00213429,  0.07381905, -0.09397278,  0.08932504, -0.00162343,
       -0.07650761,  0.04067037, -0.14623344, -0.01521316,  0.03096902,
       -0.00218932, -0.08328622, -0.05705699,  0.05337256,  0.03251749,
        0.06499627, -0.03883306,  0.01217427,  0.0509025 , -0.03585384,
        0.0689431 ,  0.02351258,  0.04486413, -0.01371281,  0.0296316 ,
        0.02136545, -0.14522278,  0.00962873, -0.01190588, -0.02343949,
       -0.07445157, -0.00743668,  0.06643493,  0.03143901,  0.03538921,
        0.05261549,  0.00622071,  0.00512619,  0.13138519, -0.016271  ,
        0.1280664 , -0.0281569 ,  0.05304267, -0.08197889,  0.03647416,
       -0.0908702 ,  0.0907077 ,  0.0009073 , -0.00584355,  0.0216803 ,
        0.09708863, -0.03843877,  0.07444821, -0.02166734,  0.11680321,
        0.01058747, -0.03528195, -0.01671917,  0.00431578,  0.02983457,
        0.05324177, -0.01105398, -0.0105139 ,  0.02842969, -0.02374061,
       -0.09566777,  0.00259409, -0.00075548,  0.03930911,  0.00377064,
        0.01211741, -0.04258214, -0.01305003, -0.01610391, -0.07661422,
       -0.01903511, -0.06883642, -0.08518191, -0.01282962,  0.0184722 ,
        0.04440661, -0.00693423, -0.00422318,  0.01570578, -0.00632003,
       -0.00961587, -0.02984856,  0.0214809 ,  0.07136744,  0.03213349,
       -0.04010129, -0.00035848, -0.01424925,  0.06443602,  0.02018777,
        0.01943419, -0.00966864,  0.00596202, -0.03069373, -0.01564495,
       -0.05931353,  0.02222474,  0.01904519, -0.02842978, -0.00069007,
       -0.03887554, -0.05666535,  0.01283519, -0.00330482, -0.01628766,
        0.00492181, -0.05608921, -0.01671099,  0.02535864, -0.00218894,
        0.04458237,  0.07417594,  0.03866369, -0.09731697,  0.01891821,
       -0.02167555,  0.04933357, -0.05242139,  0.03721772,  0.0229468 ,
       -0.08311929, -0.00661719, -0.00621934, -0.07366215,  0.00854658,
        0.05721372, -0.04334996,  0.00494872, -0.07360718, -0.04063034,
       -0.01522357,  0.00445656, -0.09802664, -0.05989946, -0.05275297,
       -0.03157848, -0.03841926,  0.06702825, -0.08821026,  0.06974641,
        0.05465396,  0.06257062, -0.03873832,  0.11081573, -0.05601896,
       -0.03000432, -0.02636354,  0.08552916, -0.09668133,  0.02696207,
        0.00823885, -0.02628613,  0.04240276, -0.04750042,  0.02168193,
        0.07290898, -0.02299476,  0.05413065,  0.08540422, -0.00282635,
       -0.0536682 ,  0.0743058 ,  0.00220649, -0.01906369, -0.00633779,
       -0.03175312, -0.02021488, -0.03198906, -0.04739904,  0.04052622,
        0.0988438 ,  0.00562239,  0.03735855,  0.0457716 , -0.0033249 ,
        0.01441622,  0.03325477,  0.09631445,  0.04915336,  0.05992904,
       -0.00600277, -0.01433129,  0.04592302,  0.04359821, -0.13954614,
       -0.00307374, -0.06090346, -0.13478954, -0.05491044, -0.0156491 ,
        0.13602623,  0.04711536, -0.00213679, -0.11509449, -0.11057125,
        0.02938064, -0.08248176,  0.01261425,  0.0245921 ,  0.07879733,
        0.03867466, -0.07527684, -0.03336613,  0.10514716, -0.0246095 ,
       -0.06571205,  0.05439528,  0.0557172 ,  0.02308842, -0.02448075,
        0.00975912,  0.06725417,  0.04760227, -0.06176807, -0.0582995 ],
      dtype=float32)
</code></pre><h4 id="5、使用Word2vec特征"><a href="#5、使用Word2vec特征" class="headerlink" title="5、使用Word2vec特征"></a>5、使用Word2vec特征</h4><h5 id="5、1-构造向量化方法"><a href="#5、1-构造向量化方法" class="headerlink" title="5、1  构造向量化方法"></a>5、1  构造向量化方法</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="comment"># 返回特征词向量</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getWordVecs</span><span class="params">(wordList,model)</span>:</span></span><br><span class="line">    vecs = []</span><br><span class="line">    <span class="comment"># 对于一条评论中的每一个单词</span></span><br><span class="line">    <span class="keyword">for</span> word <span class="keyword">in</span> wordList:</span><br><span class="line">        word = word.replace(<span class="string">'\n'</span>,<span class="string">''</span>)</span><br><span class="line">        <span class="comment">#print word</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            vecs.append(model[word])</span><br><span class="line">        <span class="keyword">except</span> KeyError:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">return</span> np.array(vecs, dtype=<span class="string">'float'</span>)</span><br><span class="line"><span class="comment"># 将评论转化为向量模型</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">reviews_to_vec</span><span class="params">(review_list,model)</span>:</span></span><br><span class="line">    review_vecs=[]</span><br><span class="line">    <span class="comment"># 对于每一条评论，将其向量化</span></span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> review_list:</span><br><span class="line">        <span class="comment"># 将字符串按照空格分割成列表</span></span><br><span class="line">        <span class="comment">#wordList=line.split()</span></span><br><span class="line">        <span class="comment"># 得到一条评论的矩阵向量,一条语句即可得到一个二维矩阵，行数为词的个数，列数为模型设定的维度；</span></span><br><span class="line">        vecs = getWordVecs(line, model)</span><br><span class="line">        <span class="comment"># 根据得到的矩阵计算矩阵均值作为当前语句的特征词向量</span></span><br><span class="line">        <span class="keyword">if</span> len(vecs) &gt; <span class="number">0</span>:</span><br><span class="line">            vecsArray = sum(np.array(vecs)) / len(vecs)  <span class="comment"># mean</span></span><br><span class="line">            review_vecs.append(vecsArray)</span><br><span class="line">    <span class="comment"># 返回词向量表示的所有评论</span></span><br><span class="line">    <span class="keyword">return</span> review_vecs</span><br></pre></td></tr></table></figure>
<h5 id="5、2-将数据向量化"><a href="#5、2-将数据向量化" class="headerlink" title="5、2 将数据向量化"></a>5、2 将数据向量化</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">num_reviews=len(train)</span><br><span class="line">clean_train_reviews=[] <span class="comment"># 存放的是评论列表，一条评论是由单词列表组成的</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,num_reviews):</span><br><span class="line">    temp_review=review_to_wordlist(train[<span class="string">"review"</span>][i],<span class="keyword">True</span>)</span><br><span class="line">    clean_train_reviews.append(temp_review)</span><br><span class="line"><span class="comment"># 查看清洗后的数据</span></span><br><span class="line">print(clean_train_reviews[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 对测试集做相同的操作</span></span><br><span class="line">num_reviews=len(test)</span><br><span class="line">clean_test_reviews=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,num_reviews):</span><br><span class="line">    temp_review=review_to_wordlist(test[<span class="string">'review'</span>][i],<span class="keyword">True</span>)</span><br><span class="line">    clean_test_reviews.append(temp_review)</span><br></pre></td></tr></table></figure>
<pre><code>[&apos;stuff&apos;, &apos;going&apos;, &apos;moment&apos;, &apos;mj&apos;, &apos;started&apos;, &apos;listening&apos;, &apos;music&apos;, &apos;watching&apos;, &apos;odd&apos;, &apos;documentary&apos;, &apos;watched&apos;, &apos;wiz&apos;, &apos;watched&apos;, &apos;moonwalker&apos;, &apos;maybe&apos;, &apos;want&apos;, &apos;get&apos;, &apos;certain&apos;, &apos;insight&apos;, &apos;guy&apos;, &apos;thought&apos;, &apos;really&apos;, &apos;cool&apos;, &apos;eighties&apos;, &apos;maybe&apos;, &apos;make&apos;, &apos;mind&apos;, &apos;whether&apos;, &apos;guilty&apos;, &apos;innocent&apos;, &apos;moonwalker&apos;, &apos;part&apos;, &apos;biography&apos;, &apos;part&apos;, &apos;feature&apos;, &apos;film&apos;, &apos;remember&apos;, &apos;going&apos;, &apos;see&apos;, &apos;cinema&apos;, &apos;originally&apos;, &apos;released&apos;, &apos;subtle&apos;, &apos;messages&apos;, &apos;mj&apos;, &apos;feeling&apos;, &apos;towards&apos;, &apos;press&apos;, &apos;also&apos;, &apos;obvious&apos;, &apos;message&apos;, &apos;drugs&apos;, &apos;bad&apos;, &apos;kay&apos;, &apos;visually&apos;, &apos;impressive&apos;, &apos;course&apos;, &apos;michael&apos;, &apos;jackson&apos;, &apos;unless&apos;, &apos;remotely&apos;, &apos;like&apos;, &apos;mj&apos;, &apos;anyway&apos;, &apos;going&apos;, &apos;hate&apos;, &apos;find&apos;, &apos;boring&apos;, &apos;may&apos;, &apos;call&apos;, &apos;mj&apos;, &apos;egotist&apos;, &apos;consenting&apos;, &apos;making&apos;, &apos;movie&apos;, &apos;mj&apos;, &apos;fans&apos;, &apos;would&apos;, &apos;say&apos;, &apos;made&apos;, &apos;fans&apos;, &apos;true&apos;, &apos;really&apos;, &apos;nice&apos;, &apos;actual&apos;, &apos;feature&apos;, &apos;film&apos;, &apos;bit&apos;, &apos;finally&apos;, &apos;starts&apos;, &apos;minutes&apos;, &apos;excluding&apos;, &apos;smooth&apos;, &apos;criminal&apos;, &apos;sequence&apos;, &apos;joe&apos;, &apos;pesci&apos;, &apos;convincing&apos;, &apos;psychopathic&apos;, &apos;powerful&apos;, &apos;drug&apos;, &apos;lord&apos;, &apos;wants&apos;, &apos;mj&apos;, &apos;dead&apos;, &apos;bad&apos;, &apos;beyond&apos;, &apos;mj&apos;, &apos;overheard&apos;, &apos;plans&apos;, &apos;nah&apos;, &apos;joe&apos;, &apos;pesci&apos;, &apos;character&apos;, &apos;ranted&apos;, &apos;wanted&apos;, &apos;people&apos;, &apos;know&apos;, &apos;supplying&apos;, &apos;drugs&apos;, &apos;etc&apos;, &apos;dunno&apos;, &apos;maybe&apos;, &apos;hates&apos;, &apos;mj&apos;, &apos;music&apos;, &apos;lots&apos;, &apos;cool&apos;, &apos;things&apos;, &apos;like&apos;, &apos;mj&apos;, &apos;turning&apos;, &apos;car&apos;, &apos;robot&apos;, &apos;whole&apos;, &apos;speed&apos;, &apos;demon&apos;, &apos;sequence&apos;, &apos;also&apos;, &apos;director&apos;, &apos;must&apos;, &apos;patience&apos;, &apos;saint&apos;, &apos;came&apos;, &apos;filming&apos;, &apos;kiddy&apos;, &apos;bad&apos;, &apos;sequence&apos;, &apos;usually&apos;, &apos;directors&apos;, &apos;hate&apos;, &apos;working&apos;, &apos;one&apos;, &apos;kid&apos;, &apos;let&apos;, &apos;alone&apos;, &apos;whole&apos;, &apos;bunch&apos;, &apos;performing&apos;, &apos;complex&apos;, &apos;dance&apos;, &apos;scene&apos;, &apos;bottom&apos;, &apos;line&apos;, &apos;movie&apos;, &apos;people&apos;, &apos;like&apos;, &apos;mj&apos;, &apos;one&apos;, &apos;level&apos;, &apos;another&apos;, &apos;think&apos;, &apos;people&apos;, &apos;stay&apos;, &apos;away&apos;, &apos;try&apos;, &apos;give&apos;, &apos;wholesome&apos;, &apos;message&apos;, &apos;ironically&apos;, &apos;mj&apos;, &apos;bestest&apos;, &apos;buddy&apos;, &apos;movie&apos;, &apos;girl&apos;, &apos;michael&apos;, &apos;jackson&apos;, &apos;truly&apos;, &apos;one&apos;, &apos;talented&apos;, &apos;people&apos;, &apos;ever&apos;, &apos;grace&apos;, &apos;planet&apos;, &apos;guilty&apos;, &apos;well&apos;, &apos;attention&apos;, &apos;gave&apos;, &apos;subject&apos;, &apos;hmmm&apos;, &apos;well&apos;, &apos;know&apos;, &apos;people&apos;, &apos;different&apos;, &apos;behind&apos;, &apos;closed&apos;, &apos;doors&apos;, &apos;know&apos;, &apos;fact&apos;, &apos;either&apos;, &apos;extremely&apos;, &apos;nice&apos;, &apos;stupid&apos;, &apos;guy&apos;, &apos;one&apos;, &apos;sickest&apos;, &apos;liars&apos;, &apos;hope&apos;, &apos;latter&apos;]
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将清洗后的数据用向量表示</span></span><br><span class="line">train_vec=reviews_to_vec(clean_train_reviews,model)</span><br><span class="line">test_vec=reviews_to_vec(clean_test_reviews,model)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(train_vec[<span class="number">0</span>])</span><br></pre></td></tr></table></figure>
<pre><code>[-4.12214540e-02 -3.79349139e-02  4.92058553e-03  3.83373492e-02
 -2.45657221e-03  8.18741966e-03 -8.79610906e-03 -1.77715521e-03
  1.32088760e-02  1.10860562e-02  1.07725587e-02 -2.03826056e-03
 -6.47818862e-03  2.19975994e-03  3.60669386e-03 -6.05855137e-03
 -1.36809291e-02  4.23901244e-03 -8.60632074e-03 -1.22470358e-02
  1.90984706e-02 -1.82547256e-02 -1.34975893e-02 -6.18288175e-03
 -1.35384069e-03  1.21405336e-02  1.44483088e-02  1.13259193e-02
  1.89741399e-03  5.12676010e-03 -1.39281715e-03  3.23074499e-03
 -3.93561738e-03  8.09281687e-03  1.29367411e-02 -4.67313011e-03
  1.23364448e-02  2.59944830e-04  1.00361077e-02  3.50261860e-03
  1.37961732e-03 -5.03643784e-04 -8.41444710e-03 -1.40226181e-02
 -1.58165179e-02 -3.45300662e-03  7.24950322e-03 -1.22461706e-02
 -3.30349544e-03  7.58285267e-04  4.28325363e-03  1.03239213e-03
  1.41914198e-02 -3.84485975e-03 -3.39659879e-03 -2.38006394e-03
 -1.53069039e-04  3.38289491e-03 -9.98435193e-03 -2.60351885e-02
  1.44659057e-02 -2.39534181e-03 -7.16520778e-03  9.46791547e-03
 -1.04171550e-02 -3.98039501e-03  9.16166107e-03  3.70796656e-03
 -5.85292180e-03 -8.93773824e-03  1.18012830e-02  1.22757631e-02
 -9.76842746e-03 -1.13501498e-02 -6.58628962e-03  1.46483148e-02
  8.67670502e-03  1.49435605e-02 -1.19698187e-02 -2.33288583e-03
  4.06095162e-04 -1.06101402e-02 -1.60301849e-02  4.81574295e-03
 -8.17539989e-03 -1.66170598e-02 -9.30875331e-04  7.81632784e-03
 -9.27952358e-03 -9.36121523e-03 -1.26087192e-02 -1.80305672e-02
  1.86318907e-03 -1.93715744e-02 -1.10955165e-02 -2.71567362e-03
 -9.56838540e-03 -8.66433000e-03 -4.35272423e-03 -1.10486866e-02
 -1.72972109e-04  2.89158798e-03  3.60159835e-03  6.59811498e-03
 -6.54146849e-03 -7.31639369e-03  7.51837829e-04 -8.65462705e-03
  9.15930662e-03  8.95285620e-03  1.02896624e-02  9.78818544e-04
  5.63207011e-03  5.57235499e-03 -1.59190054e-03 -9.35532423e-03
 -3.96249171e-03  2.50648517e-02 -5.84957375e-03  7.37975151e-03
 -1.05417412e-02  1.02484963e-04 -1.50257244e-02  1.39091650e-02
 -1.17712126e-02  7.77766726e-03 -2.24176808e-03  7.05043707e-04
  8.67431739e-03  3.75606772e-03  9.08246107e-03  2.74517435e-03
 -2.35922815e-03  1.31304846e-02 -9.95927341e-03 -2.59129936e-02
  3.28526854e-03  1.28644373e-02 -1.20760067e-02  5.32581246e-03
  2.49877068e-02  4.61110624e-05 -9.94929249e-05 -5.19745509e-03
  3.84600100e-03  2.55921685e-02 -1.17436596e-03 -6.38690085e-03
  1.30926324e-02  9.25366330e-03  5.74752866e-03  3.67009494e-03
 -8.91258598e-03  4.00217369e-03  3.44281741e-03  9.58762693e-03
 -2.27720639e-03 -2.32857570e-02  1.38511115e-03 -8.95528520e-04
  4.61956041e-03  1.58334490e-03 -1.33953256e-02  9.33843276e-03
 -1.18030649e-02 -1.69549270e-02 -7.09789496e-03  2.20391827e-02
  4.45628540e-03  9.96538007e-03  1.65677878e-02 -7.59950671e-03
  2.65692874e-03 -8.20766386e-03 -7.06074345e-03 -2.07987758e-03
  5.14666043e-03 -2.76077065e-03 -1.95259660e-02 -4.92735231e-03
  8.77612858e-03  1.00959862e-02 -1.50249958e-02 -1.11764727e-02
  1.16610630e-02  7.64885400e-03  3.32668278e-03  3.01162971e-03
 -1.58037759e-03 -1.41781947e-03  8.98981516e-03  1.75613990e-03
  1.51191862e-02 -2.83710480e-03  1.07771752e-02  4.62977255e-03
 -2.14315927e-02  8.39924651e-03 -5.06151012e-03 -7.09692200e-03
 -4.08430280e-03  6.98304718e-03 -1.66823580e-02  1.03978790e-02
 -3.80447526e-03 -8.81291288e-04 -7.01620637e-03 -3.37387766e-04
  1.45387862e-03  2.47556191e-03 -5.43786858e-03  4.35696112e-03
  9.28427696e-03 -2.98430857e-03 -1.33052969e-02 -5.22909427e-03
  3.27453974e-03 -1.52650037e-02 -6.31197961e-03 -1.12691563e-02
  2.51482293e-02 -9.90015215e-03 -6.63267545e-03  1.19510287e-02
 -5.39413439e-03 -1.27368125e-04  1.43712242e-02 -6.93140865e-03
  5.03178495e-03 -6.58613742e-03  1.14176539e-03  5.67263818e-03
  5.86148271e-04  3.90761369e-03  1.96726647e-03 -5.55310410e-03
 -6.06663451e-03 -8.73890181e-03 -2.43698109e-02  6.17038008e-03
 -3.46167710e-03 -6.02825684e-03 -3.83132858e-03 -1.14010213e-02
  1.05697507e-03 -1.25030496e-02  1.31673251e-02 -1.55891930e-03
 -1.40483952e-03 -1.73462121e-03 -9.77388603e-03 -4.26941340e-04
 -4.54794628e-03 -1.76137344e-02  7.31736702e-04  4.76255040e-03
 -1.77207668e-03  7.87317303e-03  3.73680103e-03  4.42208364e-03
 -6.03005272e-03  9.67661470e-03  1.30678449e-02  4.52407294e-03
  3.43513604e-04  1.57824610e-02 -9.26215438e-04 -1.62585090e-03
  6.94119523e-04 -6.83462853e-03 -5.10692202e-03 -3.03575637e-03
  1.38966284e-03  1.88861779e-02  4.08470203e-03 -2.45477906e-02
 -2.42524100e-02  9.13219373e-03 -1.64326158e-02 -7.67338944e-03
 -1.64148907e-02  1.63434325e-02  5.82653699e-03 -8.66393099e-03
 -1.04383050e-02 -2.39454473e-02  1.32276766e-02 -1.50543327e-02
  4.05624122e-03  2.18779668e-02 -3.30929946e-04  8.58893936e-03
  8.00503015e-03  7.86819680e-04 -6.07566445e-03  3.53654486e-03
 -1.95318875e-02  1.86700427e-02  8.84436153e-03  7.88514732e-03]
</code></pre><h4 id="6、建模和预测"><a href="#6、建模和预测" class="headerlink" title="6、建模和预测"></a>6、建模和预测</h4><h5 id="6、1-采用随机森林模型"><a href="#6、1-采用随机森林模型" class="headerlink" title="6、1 采用随机森林模型"></a>6、1 采用随机森林模型</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.cross_validation <span class="keyword">import</span> cross_val_score</span><br><span class="line"></span><br><span class="line">forest = RandomForestClassifier( n_estimators = <span class="number">100</span>, n_jobs=<span class="number">2</span>)</span><br><span class="line">print(<span class="string">"Fitting a random forest to labeled training data..."</span>)</span><br><span class="line">forest = forest.fit( train_vec, train[<span class="string">'sentiment'</span>] )</span><br><span class="line">print(<span class="string">"随机森林分类器10折交叉验证得分: "</span>, np.mean(cross_val_score(forest, train_vec, train[<span class="string">'sentiment'</span>], cv=<span class="number">10</span>, scoring=<span class="string">'roc_auc'</span>)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 测试集</span></span><br><span class="line">result = forest.predict(test_vec)</span><br><span class="line"></span><br><span class="line">output = pd.DataFrame( data=&#123;<span class="string">"id"</span>:test[<span class="string">"id"</span>], <span class="string">"sentiment"</span>:result&#125; )</span><br><span class="line">output.to_csv( <span class="string">"./data/rf_word2vec.csv"</span>, index=<span class="keyword">False</span>, quoting=<span class="number">3</span> )</span><br></pre></td></tr></table></figure>
<pre><code>随机森林分类器10折交叉验证得分:  0.91351312
</code></pre><h5 id="6、2-采用逻辑回归模型"><a href="#6、2-采用逻辑回归模型" class="headerlink" title="6、2  采用逻辑回归模型"></a>6、2  采用逻辑回归模型</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LogisticRegression <span class="keyword">as</span> LR</span><br><span class="line">model = LR()                             <span class="comment"># 逻辑回归模型</span></span><br><span class="line">model.fit(train_vec,train[<span class="string">"sentiment"</span>])</span><br><span class="line">print(<span class="string">"10折交叉验证："</span>)</span><br><span class="line">print(np.mean(cross_val_score(model,train_vec,train[<span class="string">"sentiment"</span>],scoring=<span class="string">"roc_auc"</span>)))</span><br><span class="line">test_predicted=np.array(model.predict(test_vec))</span><br><span class="line">output=pd.DataFrame(data=&#123;<span class="string">"id"</span>:test[<span class="string">"id"</span>],<span class="string">"sentiment"</span>:test_predicted&#125;)</span><br><span class="line"><span class="comment"># 写入文件</span></span><br><span class="line">output.to_csv(<span class="string">"./data/LR_word2vec.csv"</span>,index=<span class="keyword">False</span>,quoting=<span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<pre><code>10折交叉验证：
0.927272555469929
</code></pre>
        </div>
        <footer class="article-footer">
            


    <div class="a2a_kit a2a_default_style">
    <a class="a2a_dd" href="https://www.addtoany.com/share">Share</a>
    <span class="a2a_divider"></span>
    <a class="a2a_button_facebook"></a>
    <a class="a2a_button_twitter"></a>
    <a class="a2a_button_google_plus"></a>
    <a class="a2a_button_pinterest"></a>
    <a class="a2a_button_tumblr"></a>
</div>
<script type="text/javascript" src="//static.addtoany.com/menu/page.js"></script>
<style>
    .a2a_menu {
        border-radius: 4px;
    }
    .a2a_menu a {
        margin: 2px 0;
        font-size: 14px;
        line-height: 16px;
        border-radius: 4px;
        color: inherit !important;
        font-family: 'Microsoft Yahei';
    }
    #a2apage_dropdown {
        margin: 10px 0;
    }
    .a2a_mini_services {
        padding: 10px;
    }
    a.a2a_i,
    i.a2a_i {
        width: 122px;
        line-height: 16px;
    }
    a.a2a_i .a2a_svg,
    a.a2a_more .a2a_svg {
        width: 16px;
        height: 16px;
        line-height: 16px;
        vertical-align: top;
        background-size: 16px;
    }
    a.a2a_i {
        border: none !important;
    }
    a.a2a_menu_show_more_less {
        margin: 0;
        padding: 10px 0;
        line-height: 16px;
    }
    .a2a_mini_services:after{content:".";display:block;height:0;clear:both;visibility:hidden}
    .a2a_mini_services{*+height:1%;}
</style>


        </footer>
    </div>
</article>

    <section id="comments">
    
        
    <div id="disqus_thread">
        <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>

    
    </section>


                        </div>
                    </section>
                    <aside id="sidebar">
    <a class="sidebar-toggle" title="Expand Sidebar"><i class="toggle icon"></i></a>
    <div class="sidebar-top">
        <p>关注我 :</p>
        <ul class="social-links">
            
                
                <li>
                    <a class="social-tooltip" title="twitter" href="/" target="_blank" rel="noopener">
                        <i class="icon fa fa-twitter"></i>
                    </a>
                </li>
                
            
                
                <li>
                    <a class="social-tooltip" title="facebook" href="/" target="_blank" rel="noopener">
                        <i class="icon fa fa-facebook"></i>
                    </a>
                </li>
                
            
                
                <li>
                    <a class="social-tooltip" title="google-plus" href="/" target="_blank" rel="noopener">
                        <i class="icon fa fa-google-plus"></i>
                    </a>
                </li>
                
            
                
                <li>
                    <a class="social-tooltip" title="github" href="https://github.com/ppoffice/hexo-theme-hueman" target="_blank" rel="noopener">
                        <i class="icon fa fa-github"></i>
                    </a>
                </li>
                
            
                
                <li>
                    <a class="social-tooltip" title="weibo" href="/" target="_blank" rel="noopener">
                        <i class="icon fa fa-weibo"></i>
                    </a>
                </li>
                
            
                
                <li>
                    <a class="social-tooltip" title="rss" href="/" target="_blank" rel="noopener">
                        <i class="icon fa fa-rss"></i>
                    </a>
                </li>
                
            
        </ul>
    </div>
    
        
<nav id="article-nav">
    
    
        <a href="/2018/06/14/Bag of Words Meets Bags of Popcorn(2)-tfidf (1)/" id="article-nav-older" class="article-nav-link-wrap">
        <strong class="article-nav-caption">上一篇</strong>
        <p class="article-nav-title">Bag of Words Meets Bags of Popcorn(2)-tfidf</p>
        <i class="icon fa fa-chevron-left" id="icon-chevron-left"></i>
        </a>
    
</nav>

    
    <div class="widgets-container">
        
            
                

            
                
    <div class="widget-wrap">
        <h3 class="widget-title">最新文章</h3>
        <div class="widget">
            <ul id="recent-post" class="">
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2018/06/14/Bag of Words Meets Bags of Popcorn(3)-Word2Voc (1)/" class="thumbnail">
    
    
        <span class="thumbnail-image thumbnail-none"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"></p>
                            <p class="item-title"><a href="/2018/06/14/Bag of Words Meets Bags of Popcorn(3)-Word2Voc (1)/" class="title">Bag of Words Meets Bags of Popcorn(3)-Word2Voc</a></p>
                            <p class="item-date"><time datetime="2018-06-14T09:27:51.000Z" itemprop="datePublished">2018-06-14</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2018/06/14/Bag of Words Meets Bags of Popcorn(2)-tfidf (1)/" class="thumbnail">
    
    
        <span class="thumbnail-image thumbnail-none"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"></p>
                            <p class="item-title"><a href="/2018/06/14/Bag of Words Meets Bags of Popcorn(2)-tfidf (1)/" class="title">Bag of Words Meets Bags of Popcorn(2)-tfidf</a></p>
                            <p class="item-date"><time datetime="2018-06-14T06:33:55.000Z" itemprop="datePublished">2018-06-14</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2018/06/13/Bag of Words Meets Bags of Popcorn(1)-Bag of Words/" class="thumbnail">
    
    
        <span class="thumbnail-image thumbnail-none"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"></p>
                            <p class="item-title"><a href="/2018/06/13/Bag of Words Meets Bags of Popcorn(1)-Bag of Words/" class="title">Bag of Words Meets Bags of Popcorn(1)-Bag of Words</a></p>
                            <p class="item-date"><time datetime="2018-06-13T13:26:19.000Z" itemprop="datePublished">2018-06-13</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2018/06/09/一种利用web服务实现模型常驻内存的简单方法/" class="thumbnail">
    
    
        <span class="thumbnail-image thumbnail-none"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"></p>
                            <p class="item-title"><a href="/2018/06/09/一种利用web服务实现模型常驻内存的简单方法/" class="title">一种利用web服务实现模型常驻内存的简单方法</a></p>
                            <p class="item-date"><time datetime="2018-06-09T07:53:05.000Z" itemprop="datePublished">2018-06-09</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2018/06/08/利用php的curl实现post和get请求(1)/" class="thumbnail">
    
    
        <span class="thumbnail-image thumbnail-none"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"></p>
                            <p class="item-title"><a href="/2018/06/08/利用php的curl实现post和get请求(1)/" class="title">利用php的curl实现post和get请求</a></p>
                            <p class="item-date"><time datetime="2018-06-08T13:44:26.000Z" itemprop="datePublished">2018-06-08</time></p>
                        </div>
                    </li>
                
            </ul>
        </div>
    </div>

            
                

            
                
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">归档</h3>
        <div class="widget">
            <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">六月 2018</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">三月 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">一月 2018</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">十二月 2017</a><span class="archive-list-count">8</span></li></ul>
        </div>
    </div>


            
                
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">标签</h3>
        <div class="widget">
            <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Kaggle/">Kaggle</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NLTK基础教程/">NLTK基础教程</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PHP/">PHP</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/leetcode/">leetcode</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/scrapy/">scrapy</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/实验教程/">实验教程</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/文本分类/">文本分类</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/文本相似度/">文本相似度</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/笔记/">笔记</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/自然语言处理/">自然语言处理</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/资料/">资料</a><span class="tag-list-count">2</span></li></ul>
        </div>
    </div>


            
                
    <div class="widget-wrap widget-float">
        <h3 class="widget-title">标签云</h3>
        <div class="widget tagcloud">
            <a href="/tags/Kaggle/" style="font-size: 16.67px;">Kaggle</a> <a href="/tags/NLTK基础教程/" style="font-size: 16.67px;">NLTK基础教程</a> <a href="/tags/PHP/" style="font-size: 10px;">PHP</a> <a href="/tags/leetcode/" style="font-size: 10px;">leetcode</a> <a href="/tags/python/" style="font-size: 10px;">python</a> <a href="/tags/scrapy/" style="font-size: 13.33px;">scrapy</a> <a href="/tags/实验教程/" style="font-size: 16.67px;">实验教程</a> <a href="/tags/文本分类/" style="font-size: 16.67px;">文本分类</a> <a href="/tags/文本相似度/" style="font-size: 10px;">文本相似度</a> <a href="/tags/笔记/" style="font-size: 10px;">笔记</a> <a href="/tags/自然语言处理/" style="font-size: 20px;">自然语言处理</a> <a href="/tags/资料/" style="font-size: 13.33px;">资料</a>
        </div>
    </div>


            
                
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">链接</h3>
        <div class="widget">
            <ul>
                
                    <li>
                        <a href="www.baidu.com">Online Course</a>
                    </li>
                
            </ul>
        </div>
    </div>


            
        
    </div>
</aside>

                </div>
            </div>
        </div>
        <footer id="footer">
    <div class="container">
        <div class="container-inner">
            <a id="back-to-top" href="javascript:;"><i class="icon fa fa-angle-up"></i></a>
            <div class="credit">
                <h1 class="logo-wrap">
                    <a href="/" class="logo"></a>
                </h1>
                <p>&copy; 2018 IrvingBei</p>
                <span id="busuanzi_container_site_pv">
	  				本站总访问量<span id="busuanzi_value_site_pv"></span>次
				</span>
				<span id="busuanzi_container_site_uv">
					总访客数<span id="busuanzi_value_site_uv"></span>人次
				</span> 
                
                <!--<p>Powered by <a href="//hexo.io/" target="_blank">Hexo</a>. Theme by <a href="//github.com/ppoffice" target="_blank">PPOffice</a></p>-->
            </div>
             
            <div class="footer-plugins">
              
    


            </div>
        </div>
    </div>
</footer>

        
    
    <script>
    var disqus_shortname = 'hexo-theme-hueman';
    
    
    var disqus_url = 'http://yoursite.com/2018/06/14/Bag of Words Meets Bags of Popcorn(3)-Word2Voc (1)/';
    
    (function() {
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
    </script>




    
        <script src="/libs/lightgallery/js/lightgallery.min.js"></script>
        <script src="/libs/lightgallery/js/lg-thumbnail.min.js"></script>
        <script src="/libs/lightgallery/js/lg-pager.min.js"></script>
        <script src="/libs/lightgallery/js/lg-autoplay.min.js"></script>
        <script src="/libs/lightgallery/js/lg-fullscreen.min.js"></script>
        <script src="/libs/lightgallery/js/lg-zoom.min.js"></script>
        <script src="/libs/lightgallery/js/lg-hash.min.js"></script>
        <script src="/libs/lightgallery/js/lg-share.min.js"></script>
        <script src="/libs/lightgallery/js/lg-video.min.js"></script>
    
    
        <script src="/libs/justified-gallery/jquery.justifiedGallery.min.js"></script>
    
    



<!-- Custom Scripts -->
<script src="/js/main.js"></script>

    </div>
</body>
</html>

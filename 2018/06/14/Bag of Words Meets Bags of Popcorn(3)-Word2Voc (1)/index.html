<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
    <meta name="keywords" content="Bag of Words Meets Bags of Popcorn(3)-Word2Voc, IrvingBei">
    <meta name="description" content="词带模型：Bag of Words Meets Bags of Popcorn(1)-Bag of WordsTfidf模型：Bag of Words Meets Bags of Popcorn(2)-tfidf这一节采用词向量
1、读取数">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Bag of Words Meets Bags of Popcorn(3)-Word2Voc | IrvingBei</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="https://cdn.bootcss.com/font-awesome/5.11.1/css/all.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.bootcss.com/materialize/1.0.0/css/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.bootcss.com/aos/2.3.4/aos.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.bootcss.com/animate.css/3.5.1/animate.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.bootcss.com/lightgallery/1.6.11/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">
    
    <script src="https://cdn.bootcss.com/jquery/2.2.0/jquery.min.js"></script>
    
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"><!-- hexo-inject:begin --><!-- hexo-inject:end --></head>


<body>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper head-container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">IrvingBei</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>

<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">IrvingBei</div>
        <div class="logo-desc">
            
            这里没有什么东西，你就随便看看。
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/IrvingBei" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>

        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/IrvingBei" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    
<script src="https://cdn.bootcss.com/crypto-js/3.1.9-1/crypto-js.min.js"></script>
<script>
    (function() {
        let pwd = '';
        if (pwd && pwd.length > 0) {
            if (pwd !== CryptoJS.SHA256(prompt('请输入访问本文章的密码')).toString(CryptoJS.enc.Hex)) {
                alert('密码错误，将返回主页！');
                location.href = '/';
            }
        }
    })();
</script>




<div class="bg-cover pd-header post-cover" style="background-image: url('https://raw.githubusercontent.com/xiongzongyang/hexo_photo/master/bag.png')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <div class="description center-align post-title">
                        Bag of Words Meets Bags of Popcorn(3)-Word2Voc
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="https://cdn.bootcss.com/tocbot/4.8.0/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        margin: 35px 0 15px 0;
        padding-left: 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #toc-content .is-active-link::before {
        background-color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/Kaggle/">
                                <span class="chip bg-color">Kaggle</span>
                            </a>
                        
                            <a href="/tags/文本分类/">
                                <span class="chip bg-color">文本分类</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/自然语言处理/" class="post-category">
                                自然语言处理
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2018-06-14
                </div>
                

                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    7.3k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>阅读时长:&nbsp;&nbsp;
                    43 分
                </div>
                
				
                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
            
        </div>
        <hr class="clearfix">
        <div class="card-content article-card-content">
            <div id="articleContent">
                <p>词带模型：<a href="http://bei.dreamcykj.com/2018/06/13/Bag%20of%20Words%20Meets%20Bags%20of%20Popcorn%281%29-Bag%20of%20Words/" target="_blank" rel="noopener">Bag of Words Meets Bags of Popcorn(1)-Bag of Words</a><br>Tfidf模型：<a href="http://bei.dreamcykj.com/2018/06/14/Bag%20of%20Words%20Meets%20Bags%20of%20Popcorn%282%29-tfidf%20%281%29/" target="_blank" rel="noopener">Bag of Words Meets Bags of Popcorn(2)-tfidf</a><br>这一节采用词向量<br><a id="more"></a></p>
<h4 id="1、读取数据"><a href="#1、读取数据" class="headerlink" title="1、读取数据"></a>1、读取数据</h4><pre class=" language-lang-python"><code class="language-lang-python">import pandas as pd
train=pd.read_csv('./data/labeledTrainData.tsv',header=0,delimiter="\t",quoting=3)
test=pd.read_csv("./data/testData.tsv",header=0,delimiter="\t",quoting=3)
unlabeled_train=pd.read_csv("./data/unlabeledTrainData.tsv",header=0,delimiter="\t",quoting=3)
# 查看数据的大小
print("read %d labeled train reviews,%d labeled test reviews and %d unlabeled reviews\n"%(train["review"].size,len(test),len(unlabeled_train)))
</code></pre>
<pre><code>read 25000 labeled train reviews,25000 labeled test reviews and 50000 unlabeled reviews
</code></pre><h4 id="2、数据清洗"><a href="#2、数据清洗" class="headerlink" title="2、数据清洗"></a>2、数据清洗</h4><h5 id="2、1-对每一句评论进行数据清洗"><a href="#2、1-对每一句评论进行数据清洗" class="headerlink" title="2、1 对每一句评论进行数据清洗"></a>2、1 对每一句评论进行数据清洗</h5><pre class=" language-lang-python"><code class="language-lang-python">from bs4 import BeautifulSoup
import re 
from nltk.corpus import stopwords

def review_to_wordlist(review,remove_stopwords=False):
    # 去掉html标签
    review_text=BeautifulSoup(review).get_text()
    # 去掉标点符号和非法字符
    review_text=re.sub("[^a-zA-Z]"," ",review_text)
    # 全部转化为小写,并以空格分割
    words=review_text.lower().split()
    # 去停用词
    if remove_stopwords:
        stops=set(stopwords.words("english"))
        words=[w for w in words if w not in stops]
    return words
</code></pre>
<h5 id="2-2-对每一篇评论进行数据清洗"><a href="#2-2-对每一篇评论进行数据清洗" class="headerlink" title="2.2 对每一篇评论进行数据清洗"></a>2.2 对每一篇评论进行数据清洗</h5><p>将评论段落转换为句子，返回句子列表，每个句子由一堆词组成</p>
<pre class=" language-lang-python"><code class="language-lang-python">import nltk.data
tokenizer=nltk.data.load("tokenizers/punkt/english.pickle")
def review_to_sentences(review,tokenizer,remove_stopwords=False):
    # 将评论按句子分割
    raw_sentences=tokenizer.tokenize(review.strip())
    # 对一个评论的每一句话进行清洗
    sentences=[]
    for raw_sentence in raw_sentences:
        if len(raw_sentence)>0:
            # 调用数据清洗方法，对该句评论进行清洗
            sentences.append(review_to_wordlist(raw_sentence,remove_stopwords))
    # 返回清洗后的这一篇评论
    return sentences
</code></pre>
<h4 id="3、构造语料集"><a href="#3、构造语料集" class="headerlink" title="3、构造语料集"></a>3、构造语料集</h4><p>语料集中的数据包括已标注好的训练集和未标注好的训练集</p>
<pre class=" language-lang-python"><code class="language-lang-python">sentences=[] # 装有所有评论数据的一个list，相当于一个语料集,格式为：[[a.b.c].[a.b.c.d]...]
print("Parsing sentences from training set")
for review in train["review"]:
    sentences+=review_to_sentences(review,tokenizer)

print("Parsing sentence from unlabeled set")
for review in unlabeled_train["review"]:
    sentences+=review_to_sentences(review,tokenizer)
# 查看语料集的大小
print(len(sentences))
</code></pre>
<pre><code>Parsing sentences from training set
795538
</code></pre><pre class=" language-lang-python"><code class="language-lang-python"># 查看部分数据
print(sentences[0])
print(sentences[1])
</code></pre>
<pre><code>[&#39;with&#39;, &#39;all&#39;, &#39;this&#39;, &#39;stuff&#39;, &#39;going&#39;, &#39;down&#39;, &#39;at&#39;, &#39;the&#39;, &#39;moment&#39;, &#39;with&#39;, &#39;mj&#39;, &#39;i&#39;, &#39;ve&#39;, &#39;started&#39;, &#39;listening&#39;, &#39;to&#39;, &#39;his&#39;, &#39;music&#39;, &#39;watching&#39;, &#39;the&#39;, &#39;odd&#39;, &#39;documentary&#39;, &#39;here&#39;, &#39;and&#39;, &#39;there&#39;, &#39;watched&#39;, &#39;the&#39;, &#39;wiz&#39;, &#39;and&#39;, &#39;watched&#39;, &#39;moonwalker&#39;, &#39;again&#39;]
[&#39;maybe&#39;, &#39;i&#39;, &#39;just&#39;, &#39;want&#39;, &#39;to&#39;, &#39;get&#39;, &#39;a&#39;, &#39;certain&#39;, &#39;insight&#39;, &#39;into&#39;, &#39;this&#39;, &#39;guy&#39;, &#39;who&#39;, &#39;i&#39;, &#39;thought&#39;, &#39;was&#39;, &#39;really&#39;, &#39;cool&#39;, &#39;in&#39;, &#39;the&#39;, &#39;eighties&#39;, &#39;just&#39;, &#39;to&#39;, &#39;maybe&#39;, &#39;make&#39;, &#39;up&#39;, &#39;my&#39;, &#39;mind&#39;, &#39;whether&#39;, &#39;he&#39;, &#39;is&#39;, &#39;guilty&#39;, &#39;or&#39;, &#39;innocent&#39;]
</code></pre><h4 id="4、构建word2vec模型"><a href="#4、构建word2vec模型" class="headerlink" title="4、构建word2vec模型"></a>4、构建word2vec模型</h4><p>这里主要使用gensim里的word2vec，相关介绍和使用情况见：python︱gensim训练word2vec及相关函数与功能理解 <a href="https://blog.csdn.net/sinat_26917383/article/details/69803018" target="_blank" rel="noopener">https://blog.csdn.net/sinat_26917383/article/details/69803018</a></p>
<h5 id="4、1训练模型"><a href="#4、1训练模型" class="headerlink" title="4、1训练模型"></a>4、1训练模型</h5><pre class=" language-lang-python"><code class="language-lang-python">import gensim,logging
logging.basicConfig(format="%(asctime)s : %(levelname)s : %(message)s",level=logging.INFO)

num_features=300
min_word_count=40
num_workers=4
context=10
downsampling=1e-3
print("Training model...")
model=gensim.models.Word2Vec(sentences,workers=num_workers,size=num_features,min_count=min_word_count,window=context,sample=downsampling)
model.init_sims(replace=True)
model_name="300features_40minwords_10context"
model.save("./data/"+model_name)
</code></pre>
<pre><code>2018-06-14 16:17:04,394 : INFO : collecting all words and their counts
2018-06-14 16:17:04,394 : INFO : PROGRESS: at sentence #0, processed 0 words, keeping 0 word types
2018-06-14 16:17:04,439 : INFO : PROGRESS: at sentence #10000, processed 225803 words, keeping 17776 word types
2018-06-14 16:17:04,486 : INFO : PROGRESS: at sentence #20000, processed 451892 words, keeping 24948 word types
2018-06-14 16:17:04,530 : INFO : PROGRESS: at sentence #30000, processed 671315 words, keeping 30034 word types
2018-06-14 16:17:04,576 : INFO : PROGRESS: at sentence #40000, processed 897815 words, keeping 34348 word types


Training model...


2018-06-14 16:17:04,621 : INFO : PROGRESS: at sentence #50000, processed 1116963 words, keeping 37761 word types
2018-06-14 16:17:04,666 : INFO : PROGRESS: at sentence #60000, processed 1338404 words, keeping 40723 word types
2018-06-14 16:17:04,711 : INFO : PROGRESS: at sentence #70000, processed 1561580 words, keeping 43333 word types
2018-06-14 16:17:04,759 : INFO : PROGRESS: at sentence #80000, processed 1780887 words, keeping 45714 word types
2018-06-14 16:17:04,804 : INFO : PROGRESS: at sentence #90000, processed 2004996 words, keeping 48135 word types
2018-06-14 16:17:04,849 : INFO : PROGRESS: at sentence #100000, processed 2226966 words, keeping 50207 word types
2018-06-14 16:17:04,894 : INFO : PROGRESS: at sentence #110000, processed 2446580 words, keeping 52081 word types
2018-06-14 16:17:04,939 : INFO : PROGRESS: at sentence #120000, processed 2668775 words, keeping 54119 word types
2018-06-14 16:17:04,985 : INFO : PROGRESS: at sentence #130000, processed 2894303 words, keeping 55847 word types
2018-06-14 16:17:05,029 : INFO : PROGRESS: at sentence #140000, processed 3107005 words, keeping 57346 word types
2018-06-14 16:17:05,075 : INFO : PROGRESS: at sentence #150000, processed 3332627 words, keeping 59055 word types
2018-06-14 16:17:05,120 : INFO : PROGRESS: at sentence #160000, processed 3555315 words, keeping 60617 word types
2018-06-14 16:17:05,166 : INFO : PROGRESS: at sentence #170000, processed 3778655 words, keeping 62077 word types
2018-06-14 16:17:05,212 : INFO : PROGRESS: at sentence #180000, processed 3999236 words, keeping 63496 word types
2018-06-14 16:17:05,258 : INFO : PROGRESS: at sentence #190000, processed 4224449 words, keeping 64794 word types
2018-06-14 16:17:05,304 : INFO : PROGRESS: at sentence #200000, processed 4448603 words, keeping 66087 word types
2018-06-14 16:17:05,350 : INFO : PROGRESS: at sentence #210000, processed 4669967 words, keeping 67390 word types
2018-06-14 16:17:05,397 : INFO : PROGRESS: at sentence #220000, processed 4894968 words, keeping 68697 word types
2018-06-14 16:17:05,443 : INFO : PROGRESS: at sentence #230000, processed 5117545 words, keeping 69958 word types
2018-06-14 16:17:05,490 : INFO : PROGRESS: at sentence #240000, processed 5345050 words, keeping 71167 word types
2018-06-14 16:17:05,535 : INFO : PROGRESS: at sentence #250000, processed 5559165 words, keeping 72351 word types
2018-06-14 16:17:05,581 : INFO : PROGRESS: at sentence #260000, processed 5779146 words, keeping 73478 word types
2018-06-14 16:17:05,627 : INFO : PROGRESS: at sentence #270000, processed 6000435 words, keeping 74767 word types
2018-06-14 16:17:05,674 : INFO : PROGRESS: at sentence #280000, processed 6226314 words, keeping 76369 word types
2018-06-14 16:17:05,720 : INFO : PROGRESS: at sentence #290000, processed 6449474 words, keeping 77839 word types
2018-06-14 16:17:05,767 : INFO : PROGRESS: at sentence #300000, processed 6674077 words, keeping 79171 word types
2018-06-14 16:17:05,814 : INFO : PROGRESS: at sentence #310000, processed 6899391 words, keeping 80480 word types
2018-06-14 16:17:05,861 : INFO : PROGRESS: at sentence #320000, processed 7124278 words, keeping 81808 word types
2018-06-14 16:17:05,908 : INFO : PROGRESS: at sentence #330000, processed 7346021 words, keeping 83030 word types
2018-06-14 16:17:05,956 : INFO : PROGRESS: at sentence #340000, processed 7575533 words, keeping 84280 word types
2018-06-14 16:17:06,002 : INFO : PROGRESS: at sentence #350000, processed 7798803 words, keeping 85425 word types
2018-06-14 16:17:06,048 : INFO : PROGRESS: at sentence #360000, processed 8019427 words, keeping 86596 word types
2018-06-14 16:17:06,100 : INFO : PROGRESS: at sentence #370000, processed 8246619 words, keeping 87708 word types
2018-06-14 16:17:06,146 : INFO : PROGRESS: at sentence #380000, processed 8471766 words, keeping 88878 word types
2018-06-14 16:17:06,194 : INFO : PROGRESS: at sentence #390000, processed 8701497 words, keeping 89907 word types
2018-06-14 16:17:06,240 : INFO : PROGRESS: at sentence #400000, processed 8924446 words, keeping 90916 word types
2018-06-14 16:17:06,286 : INFO : PROGRESS: at sentence #410000, processed 9145796 words, keeping 91880 word types
2018-06-14 16:17:06,331 : INFO : PROGRESS: at sentence #420000, processed 9366876 words, keeping 92912 word types
2018-06-14 16:17:06,378 : INFO : PROGRESS: at sentence #430000, processed 9594413 words, keeping 93932 word types
2018-06-14 16:17:06,425 : INFO : PROGRESS: at sentence #440000, processed 9821166 words, keeping 94906 word types
2018-06-14 16:17:06,471 : INFO : PROGRESS: at sentence #450000, processed 10044928 words, keeping 96036 word types
2018-06-14 16:17:06,519 : INFO : PROGRESS: at sentence #460000, processed 10277688 words, keeping 97088 word types
2018-06-14 16:17:06,566 : INFO : PROGRESS: at sentence #470000, processed 10505613 words, keeping 97933 word types
2018-06-14 16:17:06,612 : INFO : PROGRESS: at sentence #480000, processed 10725997 words, keeping 98862 word types
2018-06-14 16:17:06,659 : INFO : PROGRESS: at sentence #490000, processed 10952741 words, keeping 99871 word types
2018-06-14 16:17:06,704 : INFO : PROGRESS: at sentence #500000, processed 11174397 words, keeping 100765 word types
2018-06-14 16:17:06,752 : INFO : PROGRESS: at sentence #510000, processed 11399672 words, keeping 101699 word types
2018-06-14 16:17:06,798 : INFO : PROGRESS: at sentence #520000, processed 11623020 words, keeping 102598 word types
2018-06-14 16:17:06,845 : INFO : PROGRESS: at sentence #530000, processed 11847418 words, keeping 103400 word types
2018-06-14 16:17:06,893 : INFO : PROGRESS: at sentence #540000, processed 12072033 words, keeping 104265 word types
2018-06-14 16:17:06,942 : INFO : PROGRESS: at sentence #550000, processed 12297571 words, keeping 105133 word types
2018-06-14 16:17:06,990 : INFO : PROGRESS: at sentence #560000, processed 12518861 words, keeping 105997 word types
2018-06-14 16:17:07,040 : INFO : PROGRESS: at sentence #570000, processed 12747916 words, keeping 106787 word types
2018-06-14 16:17:07,089 : INFO : PROGRESS: at sentence #580000, processed 12969412 words, keeping 107665 word types
2018-06-14 16:17:07,138 : INFO : PROGRESS: at sentence #590000, processed 13194937 words, keeping 108501 word types
2018-06-14 16:17:07,197 : INFO : PROGRESS: at sentence #600000, processed 13417135 words, keeping 109218 word types
2018-06-14 16:17:07,245 : INFO : PROGRESS: at sentence #610000, processed 13638158 words, keeping 110092 word types
2018-06-14 16:17:07,294 : INFO : PROGRESS: at sentence #620000, processed 13864483 words, keeping 110837 word types
2018-06-14 16:17:07,343 : INFO : PROGRESS: at sentence #630000, processed 14088769 words, keeping 111610 word types
2018-06-14 16:17:07,392 : INFO : PROGRESS: at sentence #640000, processed 14309552 words, keeping 112416 word types
2018-06-14 16:17:07,441 : INFO : PROGRESS: at sentence #650000, processed 14535308 words, keeping 113196 word types
2018-06-14 16:17:07,490 : INFO : PROGRESS: at sentence #660000, processed 14758098 words, keeping 113945 word types
2018-06-14 16:17:07,538 : INFO : PROGRESS: at sentence #670000, processed 14981482 words, keeping 114643 word types
2018-06-14 16:17:07,587 : INFO : PROGRESS: at sentence #680000, processed 15206314 words, keeping 115354 word types
2018-06-14 16:17:07,636 : INFO : PROGRESS: at sentence #690000, processed 15428507 words, keeping 116131 word types
2018-06-14 16:17:07,686 : INFO : PROGRESS: at sentence #700000, processed 15657213 words, keeping 116943 word types
2018-06-14 16:17:07,732 : INFO : PROGRESS: at sentence #710000, processed 15880202 words, keeping 117596 word types
2018-06-14 16:17:07,779 : INFO : PROGRESS: at sentence #720000, processed 16105489 words, keeping 118221 word types
2018-06-14 16:17:07,826 : INFO : PROGRESS: at sentence #730000, processed 16331870 words, keeping 118954 word types
2018-06-14 16:17:07,872 : INFO : PROGRESS: at sentence #740000, processed 16552903 words, keeping 119668 word types
2018-06-14 16:17:07,918 : INFO : PROGRESS: at sentence #750000, processed 16771230 words, keeping 120295 word types
2018-06-14 16:17:07,964 : INFO : PROGRESS: at sentence #760000, processed 16990622 words, keeping 120930 word types
2018-06-14 16:17:08,012 : INFO : PROGRESS: at sentence #770000, processed 17217759 words, keeping 121703 word types
2018-06-14 16:17:08,060 : INFO : PROGRESS: at sentence #780000, processed 17447905 words, keeping 122402 word types
2018-06-14 16:17:08,108 : INFO : PROGRESS: at sentence #790000, processed 17674981 words, keeping 123066 word types
2018-06-14 16:17:08,134 : INFO : collected 123504 word types from a corpus of 17798082 raw words and 795538 sentences
2018-06-14 16:17:08,134 : INFO : Loading a fresh vocabulary
2018-06-14 16:17:08,204 : INFO : min_count=40 retains 16490 unique words (13% of original 123504, drops 107014)
2018-06-14 16:17:08,205 : INFO : min_count=40 leaves 17238940 word corpus (96% of original 17798082, drops 559142)
2018-06-14 16:17:08,247 : INFO : deleting the raw counts dictionary of 123504 items
2018-06-14 16:17:08,249 : INFO : sample=0.001 downsamples 48 most-common words
2018-06-14 16:17:08,250 : INFO : downsampling leaves estimated 12749658 word corpus (74.0% of prior 17238940)
2018-06-14 16:17:08,286 : INFO : estimated required memory for 16490 words and 300 dimensions: 47821000 bytes
2018-06-14 16:17:08,286 : INFO : resetting layer weights
2018-06-14 16:17:08,497 : INFO : training model with 4 workers on 16490 vocabulary and 300 features, using sg=0 hs=0 sample=0.001 negative=5 window=10
2018-06-14 16:17:09,516 : INFO : EPOCH 1 - PROGRESS: at 6.40% examples, 812589 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:10,525 : INFO : EPOCH 1 - PROGRESS: at 13.20% examples, 832030 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:11,526 : INFO : EPOCH 1 - PROGRESS: at 20.16% examples, 847270 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:12,529 : INFO : EPOCH 1 - PROGRESS: at 27.14% examples, 856397 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:13,535 : INFO : EPOCH 1 - PROGRESS: at 34.33% examples, 865561 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:14,549 : INFO : EPOCH 1 - PROGRESS: at 41.21% examples, 865831 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:15,556 : INFO : EPOCH 1 - PROGRESS: at 48.00% examples, 866028 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:16,560 : INFO : EPOCH 1 - PROGRESS: at 55.16% examples, 871678 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:17,561 : INFO : EPOCH 1 - PROGRESS: at 62.03% examples, 873356 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:18,569 : INFO : EPOCH 1 - PROGRESS: at 70.05% examples, 887453 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:19,574 : INFO : EPOCH 1 - PROGRESS: at 78.55% examples, 905131 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:20,576 : INFO : EPOCH 1 - PROGRESS: at 87.08% examples, 920073 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:21,580 : INFO : EPOCH 1 - PROGRESS: at 95.30% examples, 929252 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:22,257 : INFO : worker thread finished; awaiting finish of 3 more threads
2018-06-14 16:17:22,269 : INFO : worker thread finished; awaiting finish of 2 more threads
2018-06-14 16:17:22,279 : INFO : worker thread finished; awaiting finish of 1 more threads
2018-06-14 16:17:22,283 : INFO : worker thread finished; awaiting finish of 0 more threads
2018-06-14 16:17:22,284 : INFO : EPOCH - 1 : training on 17798082 raw words (12749777 effective words) took 13.8s, 925879 effective words/s
2018-06-14 16:17:23,304 : INFO : EPOCH 2 - PROGRESS: at 8.00% examples, 1007006 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:24,312 : INFO : EPOCH 2 - PROGRESS: at 16.61% examples, 1043247 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:25,319 : INFO : EPOCH 2 - PROGRESS: at 24.73% examples, 1036444 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:26,323 : INFO : EPOCH 2 - PROGRESS: at 31.73% examples, 997990 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:27,344 : INFO : EPOCH 2 - PROGRESS: at 38.79% examples, 974442 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:28,345 : INFO : EPOCH 2 - PROGRESS: at 45.83% examples, 962075 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:29,345 : INFO : EPOCH 2 - PROGRESS: at 52.83% examples, 952391 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:30,351 : INFO : EPOCH 2 - PROGRESS: at 59.61% examples, 942736 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:31,357 : INFO : EPOCH 2 - PROGRESS: at 66.74% examples, 938270 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:32,357 : INFO : EPOCH 2 - PROGRESS: at 73.62% examples, 932470 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:33,366 : INFO : EPOCH 2 - PROGRESS: at 80.53% examples, 926935 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:34,378 : INFO : EPOCH 2 - PROGRESS: at 87.08% examples, 918591 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:35,390 : INFO : EPOCH 2 - PROGRESS: at 94.27% examples, 917532 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:36,174 : INFO : worker thread finished; awaiting finish of 3 more threads
2018-06-14 16:17:36,183 : INFO : worker thread finished; awaiting finish of 2 more threads
2018-06-14 16:17:36,192 : INFO : worker thread finished; awaiting finish of 1 more threads
2018-06-14 16:17:36,192 : INFO : worker thread finished; awaiting finish of 0 more threads
2018-06-14 16:17:36,193 : INFO : EPOCH - 2 : training on 17798082 raw words (12750854 effective words) took 13.9s, 917479 effective words/s
2018-06-14 16:17:37,202 : INFO : EPOCH 3 - PROGRESS: at 7.77% examples, 984985 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:38,212 : INFO : EPOCH 3 - PROGRESS: at 16.44% examples, 1034693 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:39,216 : INFO : EPOCH 3 - PROGRESS: at 25.10% examples, 1055381 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:40,227 : INFO : EPOCH 3 - PROGRESS: at 33.83% examples, 1063504 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:41,229 : INFO : EPOCH 3 - PROGRESS: at 42.30% examples, 1067870 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:42,236 : INFO : EPOCH 3 - PROGRESS: at 50.79% examples, 1069786 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:43,243 : INFO : EPOCH 3 - PROGRESS: at 59.22% examples, 1071100 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:44,251 : INFO : EPOCH 3 - PROGRESS: at 67.75% examples, 1071922 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:45,253 : INFO : EPOCH 3 - PROGRESS: at 76.27% examples, 1073438 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:46,257 : INFO : EPOCH 3 - PROGRESS: at 84.78% examples, 1074300 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:47,261 : INFO : EPOCH 3 - PROGRESS: at 93.12% examples, 1073178 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:48,053 : INFO : worker thread finished; awaiting finish of 3 more threads
2018-06-14 16:17:48,059 : INFO : worker thread finished; awaiting finish of 2 more threads
2018-06-14 16:17:48,062 : INFO : worker thread finished; awaiting finish of 1 more threads
2018-06-14 16:17:48,071 : INFO : worker thread finished; awaiting finish of 0 more threads
2018-06-14 16:17:48,072 : INFO : EPOCH - 3 : training on 17798082 raw words (12748789 effective words) took 11.9s, 1073879 effective words/s
2018-06-14 16:17:49,091 : INFO : EPOCH 4 - PROGRESS: at 8.00% examples, 1005623 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:50,106 : INFO : EPOCH 4 - PROGRESS: at 16.61% examples, 1038972 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:51,116 : INFO : EPOCH 4 - PROGRESS: at 25.16% examples, 1051314 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:52,122 : INFO : EPOCH 4 - PROGRESS: at 33.77% examples, 1058149 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:53,133 : INFO : EPOCH 4 - PROGRESS: at 42.24% examples, 1061681 words/s, in_qsize 6, out_qsize 1
2018-06-14 16:17:54,141 : INFO : EPOCH 4 - PROGRESS: at 50.74% examples, 1064474 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:55,151 : INFO : EPOCH 4 - PROGRESS: at 59.17% examples, 1066074 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:56,161 : INFO : EPOCH 4 - PROGRESS: at 67.69% examples, 1067360 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:57,163 : INFO : EPOCH 4 - PROGRESS: at 75.94% examples, 1065426 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:58,166 : INFO : EPOCH 4 - PROGRESS: at 82.15% examples, 1038088 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:17:59,183 : INFO : EPOCH 4 - PROGRESS: at 88.92% examples, 1020976 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:18:00,189 : INFO : EPOCH 4 - PROGRESS: at 95.65% examples, 1006423 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:18:00,821 : INFO : worker thread finished; awaiting finish of 3 more threads
2018-06-14 16:18:00,829 : INFO : worker thread finished; awaiting finish of 2 more threads
2018-06-14 16:18:00,830 : INFO : worker thread finished; awaiting finish of 1 more threads
2018-06-14 16:18:00,833 : INFO : worker thread finished; awaiting finish of 0 more threads
2018-06-14 16:18:00,833 : INFO : EPOCH - 4 : training on 17798082 raw words (12749357 effective words) took 12.8s, 999843 effective words/s
2018-06-14 16:18:01,847 : INFO : EPOCH 5 - PROGRESS: at 8.11% examples, 1027303 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:18:02,858 : INFO : EPOCH 5 - PROGRESS: at 17.00% examples, 1069428 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:18:03,860 : INFO : EPOCH 5 - PROGRESS: at 25.86% examples, 1086074 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:18:04,863 : INFO : EPOCH 5 - PROGRESS: at 34.70% examples, 1093967 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:18:05,865 : INFO : EPOCH 5 - PROGRESS: at 43.30% examples, 1095208 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:18:06,868 : INFO : EPOCH 5 - PROGRESS: at 52.04% examples, 1097950 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:18:07,869 : INFO : EPOCH 5 - PROGRESS: at 60.69% examples, 1100176 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:18:08,878 : INFO : EPOCH 5 - PROGRESS: at 68.09% examples, 1079587 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:18:09,888 : INFO : EPOCH 5 - PROGRESS: at 74.91% examples, 1055508 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:18:10,900 : INFO : EPOCH 5 - PROGRESS: at 81.64% examples, 1034528 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:18:11,905 : INFO : EPOCH 5 - PROGRESS: at 88.40% examples, 1018906 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:18:12,916 : INFO : EPOCH 5 - PROGRESS: at 95.11% examples, 1004071 words/s, in_qsize 7, out_qsize 0
2018-06-14 16:18:13,626 : INFO : worker thread finished; awaiting finish of 3 more threads
2018-06-14 16:18:13,635 : INFO : worker thread finished; awaiting finish of 2 more threads
2018-06-14 16:18:13,642 : INFO : worker thread finished; awaiting finish of 1 more threads
2018-06-14 16:18:13,643 : INFO : worker thread finished; awaiting finish of 0 more threads
2018-06-14 16:18:13,643 : INFO : EPOCH - 5 : training on 17798082 raw words (12749291 effective words) took 12.8s, 996145 effective words/s
2018-06-14 16:18:13,644 : INFO : training on a 88990410 raw words (63748068 effective words) took 65.1s, 978532 effective words/s
2018-06-14 16:18:13,645 : INFO : precomputing L2-norms of word weight vectors
2018-06-14 16:18:13,823 : INFO : saving Word2Vec object under ./data/300features_40minwords_10context, separately None
2018-06-14 16:18:13,824 : INFO : not storing attribute vectors_norm
2018-06-14 16:18:13,826 : INFO : not storing attribute cum_table
2018-06-14 16:18:14,267 : INFO : saved ./data/300features_40minwords_10context
</code></pre><h5 id="4、2-预览模型"><a href="#4、2-预览模型" class="headerlink" title="4、2 预览模型"></a>4、2 预览模型</h5><p>(1) 找出不匹配的词语</p>
<pre class=" language-lang-python"><code class="language-lang-python">model.doesnt_match("man woman child kitchen".split())
</code></pre>
<pre><code>&#39;kitchen&#39;
</code></pre><pre class=" language-lang-python"><code class="language-lang-python">model.doesnt_match("france england germany berlin".split())
</code></pre>
<pre><code>&#39;berlin&#39;
</code></pre><pre class=" language-lang-python"><code class="language-lang-python">model.doesnt_match("paris berlin london austria".split())
</code></pre>
<pre><code>&#39;paris&#39;
</code></pre><p>(2)匹配相似的词</p>
<pre class=" language-lang-python"><code class="language-lang-python">model.most_similar("man")
</code></pre>
<pre><code>[(&#39;woman&#39;, 0.6306251883506775),
 (&#39;lady&#39;, 0.5747369527816772),
 (&#39;lad&#39;, 0.5607120990753174),
 (&#39;farmer&#39;, 0.5333519577980042),
 (&#39;soldier&#39;, 0.5211611986160278),
 (&#39;businessman&#39;, 0.5164321660995483),
 (&#39;men&#39;, 0.514143705368042),
 (&#39;guy&#39;, 0.5132095813751221),
 (&#39;gentleman&#39;, 0.5126838088035583),
 (&#39;chap&#39;, 0.5047199130058289)]
</code></pre><pre class=" language-lang-python"><code class="language-lang-python">model.most_similar("queen")
</code></pre>
<pre><code>[(&#39;princess&#39;, 0.665077805519104),
 (&#39;belle&#39;, 0.6354636549949646),
 (&#39;bride&#39;, 0.6334044933319092),
 (&#39;stepmother&#39;, 0.6092513799667358),
 (&#39;victoria&#39;, 0.603207528591156),
 (&#39;maid&#39;, 0.5809364318847656),
 (&#39;angela&#39;, 0.5791389346122742),
 (&#39;showgirl&#39;, 0.5766100883483887),
 (&#39;seductress&#39;, 0.576302170753479),
 (&#39;maria&#39;, 0.5733033418655396)]
</code></pre><pre class=" language-lang-python"><code class="language-lang-python">model.most_similar("awful")
</code></pre>
<pre><code>[(&#39;terrible&#39;, 0.7602646350860596),
 (&#39;atrocious&#39;, 0.7441849708557129),
 (&#39;horrible&#39;, 0.7187424898147583),
 (&#39;abysmal&#39;, 0.7162792682647705),
 (&#39;dreadful&#39;, 0.6996028423309326),
 (&#39;appalling&#39;, 0.6916007995605469),
 (&#39;horrendous&#39;, 0.6912209987640381),
 (&#39;horrid&#39;, 0.6631687879562378),
 (&#39;lousy&#39;, 0.6283937692642212),
 (&#39;amateurish&#39;, 0.616948127746582)]
</code></pre><p>（3）查看模型内部词向量内容</p>
<pre class=" language-lang-python"><code class="language-lang-python">model['flower']
</code></pre>
<pre><code>array([-0.04672493,  0.08882798, -0.00798039,  0.01940776,  0.00703776,
       -0.0983417 , -0.03383616,  0.01253733,  0.1013744 , -0.06382444,
        0.05575086, -0.03603694, -0.1734672 , -0.10947284,  0.04083061,
       -0.02300067, -0.08912303, -0.01208846, -0.03741381, -0.03776918,
        0.00958646, -0.04842193,  0.03746754,  0.00568479, -0.03371157,
        0.05098233,  0.03344997, -0.04607128, -0.03911143, -0.09323646,
        0.05823594,  0.05683371, -0.03013518,  0.03097427,  0.02941879,
        0.05783584,  0.02902247,  0.02647943, -0.04254698, -0.01946488,
       -0.07041467,  0.07577515,  0.01416771,  0.06094591,  0.05511365,
        0.02002226, -0.09548184,  0.01083773,  0.11513695, -0.00510942,
        0.10982258,  0.0311219 , -0.11257961, -0.04740267,  0.02418482,
       -0.13684008, -0.01806154, -0.03081693, -0.02723986, -0.02626858,
       -0.02271062,  0.02877414, -0.18940935,  0.15113354, -0.08325452,
        0.13035862,  0.03562083,  0.05715419,  0.05659889,  0.11132292,
       -0.11618023, -0.02525528, -0.04214492, -0.01676722, -0.11387489,
        0.01289947,  0.06157506,  0.02216116,  0.03087287,  0.00053991,
        0.00213429,  0.07381905, -0.09397278,  0.08932504, -0.00162343,
       -0.07650761,  0.04067037, -0.14623344, -0.01521316,  0.03096902,
       -0.00218932, -0.08328622, -0.05705699,  0.05337256,  0.03251749,
        0.06499627, -0.03883306,  0.01217427,  0.0509025 , -0.03585384,
        0.0689431 ,  0.02351258,  0.04486413, -0.01371281,  0.0296316 ,
        0.02136545, -0.14522278,  0.00962873, -0.01190588, -0.02343949,
       -0.07445157, -0.00743668,  0.06643493,  0.03143901,  0.03538921,
        0.05261549,  0.00622071,  0.00512619,  0.13138519, -0.016271  ,
        0.1280664 , -0.0281569 ,  0.05304267, -0.08197889,  0.03647416,
       -0.0908702 ,  0.0907077 ,  0.0009073 , -0.00584355,  0.0216803 ,
        0.09708863, -0.03843877,  0.07444821, -0.02166734,  0.11680321,
        0.01058747, -0.03528195, -0.01671917,  0.00431578,  0.02983457,
        0.05324177, -0.01105398, -0.0105139 ,  0.02842969, -0.02374061,
       -0.09566777,  0.00259409, -0.00075548,  0.03930911,  0.00377064,
        0.01211741, -0.04258214, -0.01305003, -0.01610391, -0.07661422,
       -0.01903511, -0.06883642, -0.08518191, -0.01282962,  0.0184722 ,
        0.04440661, -0.00693423, -0.00422318,  0.01570578, -0.00632003,
       -0.00961587, -0.02984856,  0.0214809 ,  0.07136744,  0.03213349,
       -0.04010129, -0.00035848, -0.01424925,  0.06443602,  0.02018777,
        0.01943419, -0.00966864,  0.00596202, -0.03069373, -0.01564495,
       -0.05931353,  0.02222474,  0.01904519, -0.02842978, -0.00069007,
       -0.03887554, -0.05666535,  0.01283519, -0.00330482, -0.01628766,
        0.00492181, -0.05608921, -0.01671099,  0.02535864, -0.00218894,
        0.04458237,  0.07417594,  0.03866369, -0.09731697,  0.01891821,
       -0.02167555,  0.04933357, -0.05242139,  0.03721772,  0.0229468 ,
       -0.08311929, -0.00661719, -0.00621934, -0.07366215,  0.00854658,
        0.05721372, -0.04334996,  0.00494872, -0.07360718, -0.04063034,
       -0.01522357,  0.00445656, -0.09802664, -0.05989946, -0.05275297,
       -0.03157848, -0.03841926,  0.06702825, -0.08821026,  0.06974641,
        0.05465396,  0.06257062, -0.03873832,  0.11081573, -0.05601896,
       -0.03000432, -0.02636354,  0.08552916, -0.09668133,  0.02696207,
        0.00823885, -0.02628613,  0.04240276, -0.04750042,  0.02168193,
        0.07290898, -0.02299476,  0.05413065,  0.08540422, -0.00282635,
       -0.0536682 ,  0.0743058 ,  0.00220649, -0.01906369, -0.00633779,
       -0.03175312, -0.02021488, -0.03198906, -0.04739904,  0.04052622,
        0.0988438 ,  0.00562239,  0.03735855,  0.0457716 , -0.0033249 ,
        0.01441622,  0.03325477,  0.09631445,  0.04915336,  0.05992904,
       -0.00600277, -0.01433129,  0.04592302,  0.04359821, -0.13954614,
       -0.00307374, -0.06090346, -0.13478954, -0.05491044, -0.0156491 ,
        0.13602623,  0.04711536, -0.00213679, -0.11509449, -0.11057125,
        0.02938064, -0.08248176,  0.01261425,  0.0245921 ,  0.07879733,
        0.03867466, -0.07527684, -0.03336613,  0.10514716, -0.0246095 ,
       -0.06571205,  0.05439528,  0.0557172 ,  0.02308842, -0.02448075,
        0.00975912,  0.06725417,  0.04760227, -0.06176807, -0.0582995 ],
      dtype=float32)
</code></pre><h4 id="5、使用Word2vec特征"><a href="#5、使用Word2vec特征" class="headerlink" title="5、使用Word2vec特征"></a>5、使用Word2vec特征</h4><h5 id="5、1-构造向量化方法"><a href="#5、1-构造向量化方法" class="headerlink" title="5、1  构造向量化方法"></a>5、1  构造向量化方法</h5><pre class=" language-lang-python"><code class="language-lang-python">import numpy as np
# 返回特征词向量
def getWordVecs(wordList,model):
    vecs = []
    # 对于一条评论中的每一个单词
    for word in wordList:
        word = word.replace('\n','')
        #print word
        try:
            vecs.append(model[word])
        except KeyError:
            continue
    return np.array(vecs, dtype='float')
# 将评论转化为向量模型
def reviews_to_vec(review_list,model):
    review_vecs=[]
    # 对于每一条评论，将其向量化
    for line in review_list:
        # 将字符串按照空格分割成列表
        #wordList=line.split()
        # 得到一条评论的矩阵向量,一条语句即可得到一个二维矩阵，行数为词的个数，列数为模型设定的维度；
        vecs = getWordVecs(line, model)
        # 根据得到的矩阵计算矩阵均值作为当前语句的特征词向量
        if len(vecs) > 0:
            vecsArray = sum(np.array(vecs)) / len(vecs)  # mean
            review_vecs.append(vecsArray)
    # 返回词向量表示的所有评论
    return review_vecs
</code></pre>
<h5 id="5、2-将数据向量化"><a href="#5、2-将数据向量化" class="headerlink" title="5、2 将数据向量化"></a>5、2 将数据向量化</h5><pre class=" language-lang-python"><code class="language-lang-python">num_reviews=len(train)
clean_train_reviews=[] # 存放的是评论列表，一条评论是由单词列表组成的
for i in range(0,num_reviews):
    temp_review=review_to_wordlist(train["review"][i],True)
    clean_train_reviews.append(temp_review)
# 查看清洗后的数据
print(clean_train_reviews[0])

# 对测试集做相同的操作
num_reviews=len(test)
clean_test_reviews=[]
for i in range(0,num_reviews):
    temp_review=review_to_wordlist(test['review'][i],True)
    clean_test_reviews.append(temp_review)
</code></pre>
<pre><code>    [&#39;stuff&#39;, &#39;going&#39;, &#39;moment&#39;, &#39;mj&#39;, &#39;started&#39;, &#39;listening&#39;, &#39;music&#39;, &#39;watching&#39;, &#39;odd&#39;, &#39;documentary&#39;, &#39;watched&#39;, &#39;wiz&#39;, &#39;watched&#39;, &#39;moonwalker&#39;, &#39;maybe&#39;, &#39;want&#39;, &#39;get&#39;, &#39;certain&#39;, &#39;insight&#39;, &#39;guy&#39;, &#39;thought&#39;, &#39;really&#39;, &#39;cool&#39;, &#39;eighties&#39;, &#39;maybe&#39;, &#39;make&#39;, &#39;mind&#39;, &#39;whether&#39;, &#39;guilty&#39;, &#39;innocent&#39;, &#39;moonwalker&#39;, &#39;part&#39;, &#39;biography&#39;, &#39;part&#39;, &#39;feature&#39;, &#39;film&#39;, &#39;remember&#39;, &#39;going&#39;, &#39;see&#39;, &#39;cinema&#39;, &#39;originally&#39;, &#39;released&#39;, &#39;subtle&#39;, &#39;messages&#39;, &#39;mj&#39;, &#39;feeling&#39;, &#39;towards&#39;, &#39;press&#39;, &#39;also&#39;, &#39;obvious&#39;, &#39;message&#39;, &#39;drugs&#39;, &#39;bad&#39;, &#39;kay&#39;, &#39;visually&#39;, &#39;impressive&#39;, &#39;course&#39;, &#39;michael&#39;, &#39;jackson&#39;, &#39;unless&#39;, &#39;remotely&#39;, &#39;like&#39;, &#39;mj&#39;, &#39;anyway&#39;, &#39;going&#39;, &#39;hate&#39;, &#39;find&#39;, &#39;boring&#39;, &#39;may&#39;, &#39;call&#39;, &#39;mj&#39;, &#39;egotist&#39;, &#39;consenting&#39;, &#39;making&#39;, &#39;movie&#39;, &#39;mj&#39;, &#39;fans&#39;, &#39;would&#39;, &#39;say&#39;, &#39;made&#39;, &#39;fans&#39;, &#39;true&#39;, &#39;really&#39;, &#39;nice&#39;, &#39;actual&#39;, &#39;feature&#39;, &#39;film&#39;, &#39;bit&#39;, &#39;finally&#39;, &#39;starts&#39;, &#39;minutes&#39;, &#39;excluding&#39;, &#39;smooth&#39;, &#39;criminal&#39;, &#39;sequence&#39;, &#39;joe&#39;, &#39;pesci&#39;, &#39;convincing&#39;, &#39;psychopathic&#39;, &#39;powerful&#39;, &#39;drug&#39;, &#39;lord&#39;, &#39;wants&#39;, &#39;mj&#39;, &#39;dead&#39;, &#39;bad&#39;, &#39;beyond&#39;, &#39;mj&#39;, &#39;overheard&#39;, &#39;plans&#39;, &#39;nah&#39;, &#39;joe&#39;, &#39;pesci&#39;, &#39;character&#39;, &#39;ranted&#39;, &#39;wanted&#39;, &#39;people&#39;, &#39;know&#39;, &#39;supplying&#39;, &#39;drugs&#39;, &#39;etc&#39;, &#39;dunno&#39;, &#39;maybe&#39;, &#39;hates&#39;, &#39;mj&#39;, &#39;music&#39;, &#39;lots&#39;, &#39;cool&#39;, &#39;things&#39;, &#39;like&#39;, &#39;mj&#39;, &#39;turning&#39;, &#39;car&#39;, &#39;robot&#39;, &#39;whole&#39;, &#39;speed&#39;, &#39;demon&#39;, &#39;sequence&#39;, &#39;also&#39;, &#39;director&#39;, &#39;must&#39;, &#39;patience&#39;, &#39;saint&#39;, &#39;came&#39;, &#39;filming&#39;, &#39;kiddy&#39;, &#39;bad&#39;, &#39;sequence&#39;, &#39;usually&#39;, &#39;directors&#39;, &#39;hate&#39;, &#39;working&#39;, &#39;one&#39;, &#39;kid&#39;, &#39;let&#39;, &#39;alone&#39;, &#39;whole&#39;, &#39;bunch&#39;, &#39;performing&#39;, &#39;complex&#39;, &#39;dance&#39;, &#39;scene&#39;, &#39;bottom&#39;, &#39;line&#39;, &#39;movie&#39;, &#39;people&#39;, &#39;like&#39;, &#39;mj&#39;, &#39;one&#39;, &#39;level&#39;, &#39;another&#39;, &#39;think&#39;, &#39;people&#39;, &#39;stay&#39;, &#39;away&#39;, &#39;try&#39;, &#39;give&#39;, &#39;wholesome&#39;, &#39;message&#39;, &#39;ironically&#39;, &#39;mj&#39;, &#39;bestest&#39;, &#39;buddy&#39;, &#39;movie&#39;, &#39;girl&#39;, &#39;michael&#39;, &#39;jackson&#39;, &#39;truly&#39;, &#39;one&#39;, &#39;talented&#39;, &#39;people&#39;, &#39;ever&#39;, &#39;grace&#39;, &#39;planet&#39;, &#39;guilty&#39;, &#39;well&#39;, &#39;attention&#39;, &#39;gave&#39;, &#39;subject&#39;, &#39;hmmm&#39;, &#39;well&#39;, &#39;know&#39;, &#39;people&#39;, &#39;different&#39;, &#39;behind&#39;, &#39;closed&#39;, &#39;doors&#39;, &#39;know&#39;, &#39;fact&#39;, &#39;either&#39;, &#39;extremely&#39;, &#39;nice&#39;, &#39;stupid&#39;, &#39;guy&#39;, &#39;one&#39;, &#39;sickest&#39;, &#39;liars&#39;, &#39;hope&#39;, &#39;latter&#39;]
</code></pre><pre class=" language-lang-python"><code class="language-lang-python"># 将清洗后的数据用向量表示
train_vec=reviews_to_vec(clean_train_reviews,model)
test_vec=reviews_to_vec(clean_test_reviews,model)
</code></pre>
<pre class=" language-lang-python"><code class="language-lang-python">print(train_vec[0])
</code></pre>
<pre><code>[-4.12214540e-02 -3.79349139e-02  4.92058553e-03  3.83373492e-02
 -2.45657221e-03  8.18741966e-03 -8.79610906e-03 -1.77715521e-03
  1.32088760e-02  1.10860562e-02  1.07725587e-02 -2.03826056e-03
 -6.47818862e-03  2.19975994e-03  3.60669386e-03 -6.05855137e-03
 -1.36809291e-02  4.23901244e-03 -8.60632074e-03 -1.22470358e-02
  1.90984706e-02 -1.82547256e-02 -1.34975893e-02 -6.18288175e-03
 -1.35384069e-03  1.21405336e-02  1.44483088e-02  1.13259193e-02
  1.89741399e-03  5.12676010e-03 -1.39281715e-03  3.23074499e-03
 -3.93561738e-03  8.09281687e-03  1.29367411e-02 -4.67313011e-03
  1.23364448e-02  2.59944830e-04  1.00361077e-02  3.50261860e-03
  1.37961732e-03 -5.03643784e-04 -8.41444710e-03 -1.40226181e-02
 -1.58165179e-02 -3.45300662e-03  7.24950322e-03 -1.22461706e-02
 -3.30349544e-03  7.58285267e-04  4.28325363e-03  1.03239213e-03
  1.41914198e-02 -3.84485975e-03 -3.39659879e-03 -2.38006394e-03
 -1.53069039e-04  3.38289491e-03 -9.98435193e-03 -2.60351885e-02
  1.44659057e-02 -2.39534181e-03 -7.16520778e-03  9.46791547e-03
 -1.04171550e-02 -3.98039501e-03  9.16166107e-03  3.70796656e-03
 -5.85292180e-03 -8.93773824e-03  1.18012830e-02  1.22757631e-02
 -9.76842746e-03 -1.13501498e-02 -6.58628962e-03  1.46483148e-02
  8.67670502e-03  1.49435605e-02 -1.19698187e-02 -2.33288583e-03
  4.06095162e-04 -1.06101402e-02 -1.60301849e-02  4.81574295e-03
 -8.17539989e-03 -1.66170598e-02 -9.30875331e-04  7.81632784e-03
 -9.27952358e-03 -9.36121523e-03 -1.26087192e-02 -1.80305672e-02
  1.86318907e-03 -1.93715744e-02 -1.10955165e-02 -2.71567362e-03
 -9.56838540e-03 -8.66433000e-03 -4.35272423e-03 -1.10486866e-02
 -1.72972109e-04  2.89158798e-03  3.60159835e-03  6.59811498e-03
 -6.54146849e-03 -7.31639369e-03  7.51837829e-04 -8.65462705e-03
  9.15930662e-03  8.95285620e-03  1.02896624e-02  9.78818544e-04
  5.63207011e-03  5.57235499e-03 -1.59190054e-03 -9.35532423e-03
 -3.96249171e-03  2.50648517e-02 -5.84957375e-03  7.37975151e-03
 -1.05417412e-02  1.02484963e-04 -1.50257244e-02  1.39091650e-02
 -1.17712126e-02  7.77766726e-03 -2.24176808e-03  7.05043707e-04
  8.67431739e-03  3.75606772e-03  9.08246107e-03  2.74517435e-03
 -2.35922815e-03  1.31304846e-02 -9.95927341e-03 -2.59129936e-02
  3.28526854e-03  1.28644373e-02 -1.20760067e-02  5.32581246e-03
  2.49877068e-02  4.61110624e-05 -9.94929249e-05 -5.19745509e-03
  3.84600100e-03  2.55921685e-02 -1.17436596e-03 -6.38690085e-03
  1.30926324e-02  9.25366330e-03  5.74752866e-03  3.67009494e-03
 -8.91258598e-03  4.00217369e-03  3.44281741e-03  9.58762693e-03
 -2.27720639e-03 -2.32857570e-02  1.38511115e-03 -8.95528520e-04
  4.61956041e-03  1.58334490e-03 -1.33953256e-02  9.33843276e-03
 -1.18030649e-02 -1.69549270e-02 -7.09789496e-03  2.20391827e-02
  4.45628540e-03  9.96538007e-03  1.65677878e-02 -7.59950671e-03
  2.65692874e-03 -8.20766386e-03 -7.06074345e-03 -2.07987758e-03
  5.14666043e-03 -2.76077065e-03 -1.95259660e-02 -4.92735231e-03
  8.77612858e-03  1.00959862e-02 -1.50249958e-02 -1.11764727e-02
  1.16610630e-02  7.64885400e-03  3.32668278e-03  3.01162971e-03
 -1.58037759e-03 -1.41781947e-03  8.98981516e-03  1.75613990e-03
  1.51191862e-02 -2.83710480e-03  1.07771752e-02  4.62977255e-03
 -2.14315927e-02  8.39924651e-03 -5.06151012e-03 -7.09692200e-03
 -4.08430280e-03  6.98304718e-03 -1.66823580e-02  1.03978790e-02
 -3.80447526e-03 -8.81291288e-04 -7.01620637e-03 -3.37387766e-04
  1.45387862e-03  2.47556191e-03 -5.43786858e-03  4.35696112e-03
  9.28427696e-03 -2.98430857e-03 -1.33052969e-02 -5.22909427e-03
  3.27453974e-03 -1.52650037e-02 -6.31197961e-03 -1.12691563e-02
  2.51482293e-02 -9.90015215e-03 -6.63267545e-03  1.19510287e-02
 -5.39413439e-03 -1.27368125e-04  1.43712242e-02 -6.93140865e-03
  5.03178495e-03 -6.58613742e-03  1.14176539e-03  5.67263818e-03
  5.86148271e-04  3.90761369e-03  1.96726647e-03 -5.55310410e-03
 -6.06663451e-03 -8.73890181e-03 -2.43698109e-02  6.17038008e-03
 -3.46167710e-03 -6.02825684e-03 -3.83132858e-03 -1.14010213e-02
  1.05697507e-03 -1.25030496e-02  1.31673251e-02 -1.55891930e-03
 -1.40483952e-03 -1.73462121e-03 -9.77388603e-03 -4.26941340e-04
 -4.54794628e-03 -1.76137344e-02  7.31736702e-04  4.76255040e-03
 -1.77207668e-03  7.87317303e-03  3.73680103e-03  4.42208364e-03
 -6.03005272e-03  9.67661470e-03  1.30678449e-02  4.52407294e-03
  3.43513604e-04  1.57824610e-02 -9.26215438e-04 -1.62585090e-03
  6.94119523e-04 -6.83462853e-03 -5.10692202e-03 -3.03575637e-03
  1.38966284e-03  1.88861779e-02  4.08470203e-03 -2.45477906e-02
 -2.42524100e-02  9.13219373e-03 -1.64326158e-02 -7.67338944e-03
 -1.64148907e-02  1.63434325e-02  5.82653699e-03 -8.66393099e-03
 -1.04383050e-02 -2.39454473e-02  1.32276766e-02 -1.50543327e-02
  4.05624122e-03  2.18779668e-02 -3.30929946e-04  8.58893936e-03
  8.00503015e-03  7.86819680e-04 -6.07566445e-03  3.53654486e-03
 -1.95318875e-02  1.86700427e-02  8.84436153e-03  7.88514732e-03]
</code></pre><h4 id="6、建模和预测"><a href="#6、建模和预测" class="headerlink" title="6、建模和预测"></a>6、建模和预测</h4><h5 id="6、1-采用随机森林模型"><a href="#6、1-采用随机森林模型" class="headerlink" title="6、1 采用随机森林模型"></a>6、1 采用随机森林模型</h5><pre class=" language-lang-python"><code class="language-lang-python">from sklearn.ensemble import RandomForestClassifier
from sklearn.cross_validation import cross_val_score

forest = RandomForestClassifier( n_estimators = 100, n_jobs=2)
print("Fitting a random forest to labeled training data...")
forest = forest.fit( train_vec, train['sentiment'] )
print("随机森林分类器10折交叉验证得分: ", np.mean(cross_val_score(forest, train_vec, train['sentiment'], cv=10, scoring='roc_auc')))

# 测试集
result = forest.predict(test_vec)

output = pd.DataFrame( data={"id":test["id"], "sentiment":result} )
output.to_csv( "./data/rf_word2vec.csv", index=False, quoting=3 )
</code></pre>
<pre><code>随机森林分类器10折交叉验证得分:  0.91351312
</code></pre><h5 id="6、2-采用逻辑回归模型"><a href="#6、2-采用逻辑回归模型" class="headerlink" title="6、2  采用逻辑回归模型"></a>6、2  采用逻辑回归模型</h5><pre class=" language-lang-python"><code class="language-lang-python">from sklearn.linear_model import LogisticRegression as LR
model = LR()                             # 逻辑回归模型
model.fit(train_vec,train["sentiment"])
print("10折交叉验证：")
print(np.mean(cross_val_score(model,train_vec,train["sentiment"],scoring="roc_auc")))
test_predicted=np.array(model.predict(test_vec))
output=pd.DataFrame(data={"id":test["id"],"sentiment":test_predicted})
# 写入文件
output.to_csv("./data/LR_word2vec.csv",index=False,quoting=3)
</code></pre>
<pre><code>10折交叉验证：
0.927272555469929
</code></pre>
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://irvingbei.github.io" rel="external nofollow noreferrer">IrvingBei</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://irvingbei.github.io/2018/06/14/Bag of Words Meets Bags of Popcorn(3)-Word2Voc (1)/">https://irvingbei.github.io/2018/06/14/Bag of Words Meets Bags of Popcorn(3)-Word2Voc (1)/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="https://irvingbei.github.io" target="_blank">IrvingBei</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/Kaggle/">
                                    <span class="chip bg-color">Kaggle</span>
                                </a>
                            
                                <a href="/tags/文本分类/">
                                    <span class="chip bg-color">文本分类</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">

<div id="article-share">
    
    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.png" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>
            
        </div>
    </div>

    
        <link rel="stylesheet" href="https://cdn.bootcss.com/gitalk/1.5.0/gitalk.css">
<link rel="stylesheet" href="/css/my-gitalk.css">

<div class="card gitalk-card" data-aos="fade-up">
    <div class="comment_headling" style="font-size: 20px; font-weight: 700; position: relative; left: 20px; top: 15px; padding-bottom: 5px;">
        <i class="fas fa-comments fa-fw" aria-hidden="true"></i>
        <span>评论</span>
    </div>
    <div id="gitalk-container" class="card-content"></div>
</div>

<script src="https://cdn.bootcss.com/gitalk/1.5.0/gitalk.min.js"></script>
<script>
    let gitalk = new Gitalk({
        clientID: '02c466130912cbc57410',
        clientSecret: '5b093c033318389cf950f378e2c399a1e5417701',
        repo: 'IrvingBei.github.io',
        owner: 'IrvingBei',
        admin: "IrvingBei",
        id: '2018-06-14T17-27-51',
        distractionFreeMode: false  // Facebook-like distraction free mode
    });

    gitalk.render('gitalk-container');
</script>
    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2018/07/20/Keras examples-addition_rnn (1)/">
                    <div class="card-image">
                        
                        <img src="https://raw.githubusercontent.com/xiongzongyang/hexo_photo/master/keras01.jpg" class="responsive-img" alt="Keras examples-addition_rnn">
                        
                        <span class="card-title">Keras examples-addition_rnn</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            Keras examples-addition_rnn1、任务描述（1）任务概述：主要是利用序列学习来实现两个整数（字符串）的加法（2）任务分析：两个整数相加，需要通过神经网络来训练，于是不能够直接将整型作为神经网络的输入；想想办法，如果将
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2018-07-20
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/实验/" class="post-category">
                                    实验
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/深度学习/">
                        <span class="chip bg-color">深度学习</span>
                    </a>
                    
                    <a href="/tags/Keras/">
                        <span class="chip bg-color">Keras</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2018/06/14/Bag of Words Meets Bags of Popcorn(2)-tfidf (1)/">
                    <div class="card-image">
                        
                        <img src="https://raw.githubusercontent.com/xiongzongyang/hexo_photo/master/bag.png" class="responsive-img" alt="Bag of Words Meets Bags of Popcorn(2)-tfidf">
                        
                        <span class="card-title">Bag of Words Meets Bags of Popcorn(2)-tfidf</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            本篇是kaggle之电影评论文本情感分类（Bag of Words Meets Bags of Popcorn）实现的第二篇，语言模型选择的是TFIDF主要参考：https://www.kaggle.com/rajathmc/bag-of-
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2018-06-14
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/自然语言处理/" class="post-category">
                                    自然语言处理
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Kaggle/">
                        <span class="chip bg-color">Kaggle</span>
                    </a>
                    
                    <a href="/tags/文本分类/">
                        <span class="chip bg-color">文本分类</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>


<script>
    $('#articleContent').on('copy', function (e) {
        // IE8 or earlier browser is 'undefined'
        if (typeof window.getSelection === 'undefined') return;

        var selection = window.getSelection();
        // if the selection is short let's not annoy our users.
        if (('' + selection).length < Number.parseInt('120')) {
            return;
        }

        // create a div outside of the visible area and fill it with the selected text.
        var bodyElement = document.getElementsByTagName('body')[0];
        var newdiv = document.createElement('div');
        newdiv.style.position = 'absolute';
        newdiv.style.left = '-99999px';
        bodyElement.appendChild(newdiv);
        newdiv.appendChild(selection.getRangeAt(0).cloneContents());

        // we need a <pre> tag workaround.
        // otherwise the text inside "pre" loses all the line breaks!
        if (selection.getRangeAt(0).commonAncestorContainer.nodeName === 'PRE') {
            newdiv.innerHTML = "<pre>" + newdiv.innerHTML + "</pre>";
        }

        var url = document.location.href;
        newdiv.innerHTML += '<br />'
            + '来源: IrvingBei<br />'
            + '文章作者: IrvingBei<br />'
            + '文章链接: <a href="' + url + '">' + url + '</a><br />'
            + '本文章著作权归作者所有，任何形式的转载都请注明出处。';

        selection.selectAllChildren(newdiv);
        window.setTimeout(function () {bodyElement.removeChild(newdiv);}, 200);
    });
</script>


<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>

    
<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


<!-- 代码块折行 -->

<style type="text/css">
code[class*="language-"], pre[class*="language-"] { white-space: pre !important; }
</style>

    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="https://cdn.bootcss.com/tocbot/4.8.1/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            // headingsOffset: -205,
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>



    <footer class="page-footer bg-color">
    <div class="container row center-align">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            <span id="year">年份</span>
            <a href="https://irvingbei.github.io" target="_blank">IrvingBei</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            
            
            
            
            
            <span id="busuanzi_container_site_pv">
                |&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;<span id="busuanzi_value_site_pv"
                    class="white-color"></span>&nbsp;次
            </span>
            
            
            <span id="busuanzi_container_site_uv">
                |&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;<span id="busuanzi_value_site_uv"
                    class="white-color"></span>&nbsp;人
            </span>
            
            <br>
            
            <span id="sitetime">载入运行时间...</span>
            <script>
                function siteTime() {
                    window.setTimeout("siteTime()", 1000);
                    var seconds = 1000;
                    var minutes = seconds * 60;
                    var hours = minutes * 60;
                    var days = hours * 24;
                    var years = days * 365;
                    var today = new Date();
                    var startYear = "2019";
                    var startMonth = "6";
                    var startDate = "28";
                    var startHour = "0";
                    var startMinute = "0";
                    var startSecond = "0";
                    var todayYear = today.getFullYear();
                    var todayMonth = today.getMonth() + 1;
                    var todayDate = today.getDate();
                    var todayHour = today.getHours();
                    var todayMinute = today.getMinutes();
                    var todaySecond = today.getSeconds();
                    var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond);
                    var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
                    var diff = t2 - t1;
                    var diffYears = Math.floor(diff / years);
                    var diffDays = Math.floor((diff / days) - diffYears * 365);
                    var diffHours = Math.floor((diff - (diffYears * 365 + diffDays) * days) / hours);
                    var diffMinutes = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours) /
                        minutes);
                    var diffSeconds = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours -
                        diffMinutes * minutes) / seconds);
                    if (startYear == todayYear) {
                        document.getElementById("year").innerHTML = todayYear;
                        document.getElementById("sitetime").innerHTML = "本站已安全运行 " + diffDays + " 天 " + diffHours +
                            " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
                    } else {
                        document.getElementById("year").innerHTML = startYear + " - " + todayYear;
                        document.getElementById("sitetime").innerHTML = "本站已安全运行 " + diffYears + " 年 " + diffDays +
                            " 天 " + diffHours + " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
                    }
                }
                setInterval(siteTime, 1000);
            </script>
            
            <br>
            
            <span id="icp"><img src="/medias/icp.png" style="vertical-align: text-bottom;" />
                <a href="http://www.beian.miit.gov.cn" target="_blank">渝ICP备18002029号</a>
            </span>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/IrvingBei" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:IrvingBei@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>













    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script src="/js/search.js"></script>
<script type="text/javascript">
$(function () {
    searchFunc("/" + "search.xml", 'searchInput', 'searchResult');
});
</script>
    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="https://cdn.bootcss.com/materialize/1.0.0/js/materialize.js"></script>
    <script src="https://cdn.bootcss.com/masonry/4.0.0/masonry.pkgd.min.js"></script>
    <script src="https://cdn.bootcss.com/aos/2.3.4/aos.js"></script>
    <script src="https://cdn.bootcss.com/scrollprogress/3.0.2/scrollProgress.min.js"></script>
    <script src="https://cdn.bootcss.com/lightgallery/1.6.11/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    <!-- Global site tag (gtag.js) - Google Analytics -->


    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    

    

    
    
    
    <script src="https://cdn.bootcss.com/instant.page/2.0.0/instantpage.min.js" type="module"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
    

</body>

</html>
